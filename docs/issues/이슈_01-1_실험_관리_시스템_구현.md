## ì œëª© : ì‹¤í—˜ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„ (ExperimentManager + Session ID ìë™ ë¶€ì—¬)

---

## ğŸ“‹ ì‘ì—… ê°œìš”
**ì‘ì—… ì£¼ì œ:** ExperimentManager í´ë˜ìŠ¤ ê¸°ë°˜ ì‹¤í—˜ í´ë” êµ¬ì¡° ë° ìë™ ì¶”ì  ì‹œìŠ¤í…œ ê°œë°œ
**ë‹´ë‹¹ì:** @ìµœí˜„í™”
**ë§ˆê°ì¼:** 10/31 24:00

## ğŸ“… ê¸°ê°„
- ì‹œì‘ì¼: 2025-10-31
- ì¢…ë£Œì¼: 2025-10-31


---

## ğŸ“Œ ì´ìŠˆ ëª©ì 

ì±—ë´‡ ì‹¤í–‰ë§ˆë‹¤ ì²´ê³„ì ì¸ ì‹¤í—˜ ê´€ë¦¬ë¥¼ ìœ„í•œ ExperimentManager í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. Session ID ìë™ ë¶€ì—¬, 7ê°œ ì„œë¸Œ í´ë” êµ¬ì¡°, metadata.json ê¸°ë°˜ ì¶”ì , í‰ê°€ ì§€í‘œ ì €ì¥ ê¸°ëŠ¥ì„ ê°œë°œí•˜ì—¬ ëª¨ë“  ì‹¤í—˜ ë°ì´í„°ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ê¸°ë¡í•˜ê³  ë¶„ì„í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ë‹ˆë‹¤.

**í•µì‹¬ ëª©í‘œ:**
- ExperimentManager í´ë˜ìŠ¤ êµ¬í˜„ (with ë¬¸ ì§€ì›)
- Session ID ìë™ ë¶€ì—¬ ì‹œìŠ¤í…œ (ë‚ ì§œë³„ session_001, 002...)
- 7ê°œ ì„œë¸Œ í´ë” ìë™ ìƒì„± (tools, database, prompts, ui, outputs, evaluation, debug)
- metadata.json ê¸°ë°˜ ì‹¤í—˜ ì¶”ì 
- RAG í‰ê°€ ì§€í‘œ, Agent ì •í™•ë„, ì‘ë‹µ ì‹œê°„, ë¹„ìš© ë¶„ì„ ì €ì¥
- ì‹¤í—˜ ê²€ìƒ‰ ë° ì§‘ê³„ ìŠ¤í¬ë¦½íŠ¸ ê°œë°œ

---

## âœ… ì‘ì—… í•­ëª© ì²´í¬ë¦¬ìŠ¤íŠ¸

### Phase 1: ExperimentManager ê¸°ë³¸ êµ¬í˜„ (2ì¼)
- [ ] ExperimentManager í´ë˜ìŠ¤ êµ¬í˜„ (`src/utils/experiment_manager.py`)
  - [ ] `__init__()` ë©”ì„œë“œ êµ¬í˜„
    - [ ] ë‚ ì§œ/ì‹œê°„ ê¸°ë°˜ í´ë”ëª… ìƒì„± (YYYYMMDD_HHMMSS)
    - [ ] Session ID ìë™ ë¶€ì—¬ (_get_next_session_id)
    - [ ] ë©”ì¸ í´ë” ìƒì„± (experiments/ë‚ ì§œ/ë‚ ì§œ_ì‹œê°„_session_XXX/)
    - [ ] 7ê°œ ì„œë¸Œ í´ë” ìƒì„± (tools, database, prompts, ui, outputs, evaluation, debug)
  - [ ] `__enter__()` ë° `__exit__()` ë©”ì„œë“œ êµ¬í˜„ (with ë¬¸ ì§€ì›)
  - [ ] Logger ì´ˆê¸°í™” (chatbot.log)
  - [ ] metadata.json ìƒì„± ë° ì´ˆê¸°í™”
- [ ] Session ID ìë™ ë¶€ì—¬ ë¡œì§
  - [ ] ë‹¹ì¼ ê¸°ì¡´ ì„¸ì…˜ í´ë” ê²€ìƒ‰
  - [ ] ìµœëŒ€ session_XXX ë²ˆí˜¸ ì¶”ì¶œ
  - [ ] ë‹¤ìŒ ë²ˆí˜¸ ìë™ í• ë‹¹ (session_001, 002...)
  - [ ] ë‚ ì§œ ë³€ê²½ ì‹œ session_001ë¡œ ì´ˆê¸°í™”

### Phase 2: ë„êµ¬ë³„ Logger ë° ë°ì´í„° ì €ì¥ (2ì¼)
- [ ] ë„êµ¬ë³„ Logger ìƒì„± ë©”ì„œë“œ
  - [ ] `get_tool_logger(tool_name)` êµ¬í˜„
    - [ ] tools/ í´ë”ì— ë„êµ¬ë³„ ë¡œê·¸ íŒŒì¼ ìƒì„±
    - [ ] rag_paper.log, web_search.log, glossary.log ë“±
  - [ ] Logger ì¸ìŠ¤í„´ìŠ¤ ìºì‹± (ì¤‘ë³µ ìƒì„± ë°©ì§€)
- [ ] DB ì¿¼ë¦¬ ì €ì¥ ë©”ì„œë“œ
  - [ ] `save_db_query(query, results)` êµ¬í˜„
    - [ ] database/queries.jsonì— ì¿¼ë¦¬ ë° ê²°ê³¼ ì €ì¥
    - [ ] íƒ€ì„ìŠ¤íƒ¬í”„ ë° ì¿¼ë¦¬ íƒ€ì… ê¸°ë¡
- [ ] í”„ë¡¬í”„íŠ¸ ì €ì¥ ë©”ì„œë“œ
  - [ ] `save_prompt(prompt_type, content)` êµ¬í˜„
    - [ ] prompts/ í´ë”ì— í”„ë¡¬í”„íŠ¸ë³„ txt íŒŒì¼ ì €ì¥
    - [ ] system_prompt.txt, user_prompt.txt, rag_prompt.txt ë“±

### Phase 3: UI ë° í‰ê°€ ì§€í‘œ ì €ì¥ (2ì¼)
- [ ] UI ìƒí˜¸ì‘ìš© ì €ì¥ ë©”ì„œë“œ
  - [ ] `save_ui_interaction(interaction_data)` êµ¬í˜„
    - [ ] ui/interactions.jsonì— ì‚¬ìš©ì ì§ˆë¬¸ ë° ë‚œì´ë„ ì €ì¥
    - [ ] ëŒ€í™” í„´ ë²ˆí˜¸, íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë¡
- [ ] í‰ê°€ ì§€í‘œ ì €ì¥ ë©”ì„œë“œ (5ê°œ)
  - [ ] `save_rag_metrics(metrics)` êµ¬í˜„
    - [ ] evaluation/rag_metrics.json ì €ì¥
    - [ ] Recall@K, Precision@K, Faithfulness ê¸°ë¡
  - [ ] `save_agent_accuracy(accuracy_data)` êµ¬í˜„
    - [ ] evaluation/agent_accuracy.json ì €ì¥
    - [ ] ë„êµ¬ ì„ íƒ ì •í™•ë„, ì„±ê³µ/ì‹¤íŒ¨ìœ¨ ê¸°ë¡
  - [ ] `save_latency_report(latency_data)` êµ¬í˜„
    - [ ] evaluation/latency_report.json ì €ì¥
    - [ ] p50, p95, p99 ì‘ë‹µ ì‹œê°„ ê¸°ë¡
  - [ ] `save_cost_analysis(cost_data)` êµ¬í˜„
    - [ ] evaluation/cost_analysis.json ì €ì¥
    - [ ] í† í° ì‚¬ìš©ëŸ‰, USD/KRW ë¹„ìš© ê¸°ë¡
  - [ ] `save_test_results(test_data)` êµ¬í˜„
    - [ ] evaluation/test_results.json ì €ì¥
    - [ ] í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ë³„ ê²°ê³¼ ê¸°ë¡

### Phase 4: ì¶œë ¥ ë° ë©”íƒ€ë°ì´í„° ê´€ë¦¬ (1ì¼)
- [ ] ìµœì¢… ë‹µë³€ ì €ì¥ ë©”ì„œë“œ
  - [ ] `save_final_response(response)` êµ¬í˜„
    - [ ] outputs/response.txt ì €ì¥
    - [ ] ì§ˆë¬¸, ë‚œì´ë„, ë‹µë³€, ì‚¬ìš© ë„êµ¬ ê¸°ë¡
- [ ] ë©”íƒ€ë°ì´í„° ì—…ë°ì´íŠ¸ ë©”ì„œë“œ
  - [ ] `update_metadata(key, value)` êµ¬í˜„
    - [ ] metadata.json ë™ì  ì—…ë°ì´íŠ¸
    - [ ] ì‹¤í—˜ ì§„í–‰ ìƒí™© ë°˜ì˜
  - [ ] `_save_final_metadata()` êµ¬í˜„
    - [ ] ì‹¤í—˜ ì¢…ë£Œ ì‹œ ìµœì¢… ë©”íƒ€ë°ì´í„° ì €ì¥
    - [ ] end_time, status ì—…ë°ì´íŠ¸
- [ ] ê²½ë¡œ ë°˜í™˜ ë©”ì„œë“œ
  - [ ] `get_experiment_dir()` êµ¬í˜„
  - [ ] `get_tools_dir()`, `get_database_dir()` ë“± êµ¬í˜„

### Phase 5: ì‹¤í—˜ ê²€ìƒ‰ ë° ì§‘ê³„ ìŠ¤í¬ë¦½íŠ¸ (1ì¼)
- [ ] ì‹¤í—˜ ê²€ìƒ‰ ìŠ¤í¬ë¦½íŠ¸ (`scripts/find_experiments.py`)
  - [ ] metadata.json ê¸°ë°˜ ê²€ìƒ‰ í•¨ìˆ˜
  - [ ] í•„í„°ë§ ì˜µì…˜: ë‚œì´ë„, ì‚¬ìš© ë„êµ¬, ë‚ ì§œ, ì‘ë‹µ ì‹œê°„
  - [ ] ê²€ìƒ‰ ê²°ê³¼ ì¶œë ¥ (ê²½ë¡œ, ë©”íƒ€ë°ì´í„° ìš”ì•½)
- [ ] í‰ê°€ ì§€í‘œ ì§‘ê³„ ìŠ¤í¬ë¦½íŠ¸ (`scripts/aggregate_metrics.py`)
  - [ ] ì—¬ëŸ¬ ì‹¤í—˜ì˜ evaluation/ í´ë” ë°ì´í„° ìˆ˜ì§‘
  - [ ] í‰ê· , ìµœì†Œ, ìµœëŒ€ê°’ ê³„ì‚°
  - [ ] CSV/JSON í˜•ì‹ìœ¼ë¡œ ê²°ê³¼ ì €ì¥
  - [ ] ì‹œê°í™” ì˜µì…˜ (matplotlib)

### Phase 6: í†µí•© í…ŒìŠ¤íŠ¸ ë° ë¬¸ì„œí™” (1ì¼)
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± (`tests/test_experiment_manager.py`)
  - [ ] Session ID ìë™ ë¶€ì—¬ í…ŒìŠ¤íŠ¸
  - [ ] í´ë” êµ¬ì¡° ìƒì„± í…ŒìŠ¤íŠ¸
  - [ ] metadata.json ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸
  - [ ] í‰ê°€ ì§€í‘œ ì €ì¥ í…ŒìŠ¤íŠ¸
  - [ ] with ë¬¸ ì»¨í…ìŠ¤íŠ¸ ë§¤ë‹ˆì € í…ŒìŠ¤íŠ¸
- [ ] í†µí•© í…ŒìŠ¤íŠ¸
  - [ ] Agent + ExperimentManager í†µí•© ì‹¤í–‰
  - [ ] 7ê°œ ì„œë¸Œ í´ë”ì— ë°ì´í„° ì •ìƒ ì €ì¥ í™•ì¸
  - [ ] ê²€ìƒ‰ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì‹¤í—˜ ì¡°íšŒ í…ŒìŠ¤íŠ¸
- [ ] ì‚¬ìš© ì˜ˆì‹œ ë¬¸ì„œ ì‘ì„±
  - [ ] READMEì— ExperimentManager ì‚¬ìš©ë²• ì¶”ê°€
  - [ ] 7ê°€ì§€ ì‚¬ìš© ì˜ˆì‹œ ì½”ë“œ í¬í•¨

---

## ğŸ“¦ ì„¤ì¹˜/ì‹¤í–‰ ëª…ë ¹ì–´ ì˜ˆì‹œ

```bash
# ê°€ìƒí™˜ê²½ í™œì„±í™”
source .venv/bin/activate

# í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ (ê¸°ë³¸ íŒ¨í‚¤ì§€ì— í¬í•¨)
pip install pathlib

# ExperimentManager ë‹¨ë… í…ŒìŠ¤íŠ¸
python src/utils/experiment_manager.py

# Agentì™€ í†µí•© ì‹¤í–‰ í…ŒìŠ¤íŠ¸
python src/agent/graph.py

# ì‹¤í—˜ ê²€ìƒ‰ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
python scripts/find_experiments.py --difficulty Easy --tool rag_paper

# í‰ê°€ ì§€í‘œ ì§‘ê³„ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
python scripts/aggregate_metrics.py --date 20251031 --output results.csv

# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
pytest tests/test_experiment_manager.py -v
```

---

### âš¡ï¸ ì°¸ê³ 

**ì¤‘ìš” ì‚¬í•­:**
1. **Session ID ê·œì¹™**: ë‚ ì§œë³„ë¡œ session_001ë¶€í„° ì‹œì‘, ìë™ ì¦ê°€
2. **í´ë” êµ¬ì¡°**: 7ê°œ ì„œë¸Œ í´ë” í•„ìˆ˜ ìƒì„± (tools, database, prompts, ui, outputs, evaluation, debug)
3. **metadata.json**: ì‹¤í—˜ ì‹œì‘ ì‹œ ìƒì„±, ì¢…ë£Œ ì‹œ ìµœì¢… ì—…ë°ì´íŠ¸
4. **with ë¬¸ ì§€ì›**: `with ExperimentManager() as exp:` í˜•íƒœë¡œ ì‚¬ìš©
5. **Logger í†µí•©**: ëª¨ë“  ë¡œê·¸ëŠ” ExperimentManagerì˜ logger ì‚¬ìš©
6. **í‰ê°€ ì§€í‘œ**: 5ê°œ JSON íŒŒì¼ì— í‰ê°€ ê²°ê³¼ ì €ì¥ (rag_metrics, agent_accuracy, latency_report, cost_analysis, test_results)

**í´ë” êµ¬ì¡° ì˜ˆì‹œ:**
```
experiments/20251031/
â””â”€â”€ 20251031_103015_session_001/
    â”œâ”€â”€ metadata.json                 # ì‹¤í—˜ ë©”íƒ€ë°ì´í„°
    â”œâ”€â”€ chatbot.log                   # ë©”ì¸ ë¡œê·¸
    â”œâ”€â”€ tools/                        # ë„êµ¬ë³„ ë¡œê·¸
    â”‚   â”œâ”€â”€ rag_paper.log
    â”‚   â”œâ”€â”€ web_search.log
    â”‚   â””â”€â”€ glossary.log
    â”œâ”€â”€ database/                     # DB ì¿¼ë¦¬ ê¸°ë¡
    â”‚   â””â”€â”€ queries.json
    â”œâ”€â”€ prompts/                      # í”„ë¡¬í”„íŠ¸ ì €ì¥
    â”‚   â”œâ”€â”€ system_prompt.txt
    â”‚   â”œâ”€â”€ user_prompt.txt
    â”‚   â””â”€â”€ rag_prompt.txt
    â”œâ”€â”€ ui/                           # UI ìƒí˜¸ì‘ìš© ê¸°ë¡
    â”‚   â””â”€â”€ interactions.json
    â”œâ”€â”€ outputs/                      # ìµœì¢… ë‹µë³€
    â”‚   â””â”€â”€ response.txt
    â”œâ”€â”€ evaluation/                   # í‰ê°€ ì§€í‘œ
    â”‚   â”œâ”€â”€ rag_metrics.json
    â”‚   â”œâ”€â”€ agent_accuracy.json
    â”‚   â”œâ”€â”€ latency_report.json
    â”‚   â”œâ”€â”€ cost_analysis.json
    â”‚   â””â”€â”€ test_results.json
    â””â”€â”€ debug/                        # ë””ë²„ê·¸ ì •ë³´
        â””â”€â”€ error.log
```

**metadata.json êµ¬ì¡°:**
```json
{
  "session_id": "session_001",
  "date": "20251031",
  "start_time": "2025-10-31 10:30:15",
  "end_time": "2025-10-31 10:35:42",
  "difficulty": "Easy",
  "question": "RAGì— ëŒ€í•´ ì•Œë ¤ì¤˜",
  "tool_used": "rag_paper",
  "status": "completed",
  "response_time_sec": 327.5,
  "token_usage": {
    "prompt_tokens": 1250,
    "completion_tokens": 890,
    "total_tokens": 2140
  },
  "cost_usd": 0.0214,
  "cost_krw": 28.62
}
```

**ì£¼ì˜:**
- Session IDëŠ” í•­ìƒ 3ìë¦¬ ìˆ«ìë¡œ í¬ë§·íŒ… (001, 002, ..., 099)
- 100ê°œë¥¼ ë„˜ì–´ê°€ë©´ ìë™ìœ¼ë¡œ ìë¦¿ìˆ˜ ì¦ê°€
- ë‚ ì§œê°€ ë°”ë€Œë©´ session_001ë¡œ ë‹¤ì‹œ ì‹œì‘
- metadata.jsonì€ í•­ìƒ UTF-8 ì¸ì½”ë”©ìœ¼ë¡œ ì €ì¥
- with ë¸”ë¡ ì¢…ë£Œ ì‹œ ìë™ìœ¼ë¡œ Logger ì¢…ë£Œ ë° metadata ì—…ë°ì´íŠ¸

---

### ìœ ìš©í•œ ë§í¬

**í•„ìˆ˜ ì°¸ê³  PRD ë¬¸ì„œ:**
- [docs/PRD/01_í”„ë¡œì íŠ¸_ê°œìš”.md](../PRD/01_í”„ë¡œì íŠ¸_ê°œìš”.md) - í”„ë¡œì íŠ¸ ì „ì²´ ê°œìš”
- [docs/PRD/02_í”„ë¡œì íŠ¸_êµ¬ì¡°.md](../PRD/02_í”„ë¡œì íŠ¸_êµ¬ì¡°.md) - í´ë” êµ¬ì¡° (src/utils/)
- [docs/PRD/05_ë¡œê¹…_ì‹œìŠ¤í…œ.md](../PRD/05_ë¡œê¹…_ì‹œìŠ¤í…œ.md) â­ - Logger í´ë˜ìŠ¤ ì‚¬ìš©ë²• ë° ExperimentManager í†µí•©
- [docs/PRD/06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md](../PRD/06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md) â­ - ì‹¤í—˜ í´ë” êµ¬ì¡° ë° Session ID ê·œì¹™
- [docs/PRD/09_í‰ê°€_ê¸°ì¤€.md](../PRD/09_í‰ê°€_ê¸°ì¤€.md) - í‰ê°€ ì§€í‘œ ì •ì˜ (RAG, Agent, Latency, Cost)
- [docs/PRD/10_ê¸°ìˆ _ìš”êµ¬ì‚¬í•­.md](../PRD/10_ê¸°ìˆ _ìš”êµ¬ì‚¬í•­.md) - ê¸°ìˆ  ìŠ¤íƒ

**í•„ìˆ˜ ì°¸ê³  ì—­í•  ë¬¸ì„œ:**
- [docs/roles/ë‹´ë‹¹ì—­í• _01-1_ìµœí˜„í™”_ì‹¤í—˜_ê´€ë¦¬_ì‹œìŠ¤í…œ.md](../roles/ë‹´ë‹¹ì—­í• _01-1_ìµœí˜„í™”_ì‹¤í—˜_ê´€ë¦¬_ì‹œìŠ¤í…œ.md) â­â­â­ - ExperimentManager ì „ì²´ êµ¬í˜„ ì½”ë“œ ë° ì‚¬ìš© ì˜ˆì‹œ

**í•„ìˆ˜ ì°¸ê³  ë ˆí¼ëŸ°ìŠ¤ ë¬¸ì„œ:**
- [docs/references/ì‹¤í—˜_í´ë”_êµ¬ì¡°_ìµœì¢…ì•ˆ.md](../references/ì‹¤í—˜_í´ë”_êµ¬ì¡°_ìµœì¢…ì•ˆ.md) â­ - 7ê°œ ì„œë¸Œ í´ë” êµ¬ì¡° ë° ExperimentManager ì „ì²´ ì½”ë“œ

**ì°¸ê³  PRD ë¬¸ì„œ:**
- [docs/PRD/03_ë¸Œëœì¹˜_ì „ëµ.md](../PRD/03_ë¸Œëœì¹˜_ì „ëµ.md) - Feature ë¸Œëœì¹˜ ì „ëµ
- [docs/PRD/04_ì¼ì •_ê´€ë¦¬.md](../PRD/04_ì¼ì •_ê´€ë¦¬.md) - ê°œë°œ ì¼ì • ë° ë§ˆì¼ìŠ¤í†¤
- [docs/PRD/12_AI_Agent_ì„¤ê³„.md](../PRD/12_AI_Agent_ì„¤ê³„.md) - Agentì™€ í†µí•© ë°©ë²•

**ì™¸ë¶€ ë§í¬:**
- [Python pathlib ë¬¸ì„œ](https://docs.python.org/3/library/pathlib.html)
- [Python Context Managers](https://docs.python.org/3/reference/datamodel.html#context-managers)
- [JSON íŒŒì¼ ë‹¤ë£¨ê¸°](https://docs.python.org/3/library/json.html)

## ğŸ”– ì¶”ì²œ ë¼ë²¨

`feature` `evaluation` `config` `pipeline` `documentation` `high`

---
