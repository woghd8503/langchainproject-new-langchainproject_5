# ë‹´ë‹¹ì—­í• : ì„ì˜ˆìŠ¬ - Streamlit UI & í”„ë¡¬í”„íŠ¸ & ì›¹ê²€ìƒ‰/íŒŒì¼ì €ì¥ ë„êµ¬

## ë‹´ë‹¹ì ì •ë³´
- **ì´ë¦„**: ì„ì˜ˆìŠ¬
- **ì—­í• **: UI ë° í”„ë¡¬í”„íŠ¸ ë‹´ë‹¹
- **ì°¸ì—¬ ê¸°ê°„**: ì „ì²´ ê¸°ê°„
- **í•µì‹¬ ì—­í• **: Streamlit UI ê°œë°œ, í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿, ì›¹ ê²€ìƒ‰ ë„êµ¬, íŒŒì¼ ì €ì¥ ë„êµ¬

---

## ë‹´ë‹¹ ëª¨ë“ˆ ë° ë„êµ¬

### 1. Streamlit UI (`ui/app.py`)
- ì±„íŒ… ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
- LangGraph Agent ìŠ¤íŠ¸ë¦¬ë° ì—°ë™ (astream_events)
- StreamlitCallbackHandler êµ¬í˜„
- ë‚œì´ë„ ì„ íƒ UI (Easy/Hard)
- ëŒ€í™” íˆìŠ¤í† ë¦¬ í‘œì‹œ (ChatMessageHistory ì—°ë™)
- íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥

### 2. í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (`src/prompts/`)
- Langchain PromptTemplate êµ¬í˜„
- ChatPromptTemplateìœ¼ë¡œ Easy/Hard ëª¨ë“œ í”„ë¡¬í”„íŠ¸ êµ¬ì„±
- FewShotPromptTemplate (ì˜ˆì‹œ ê¸°ë°˜ í”„ë¡¬í”„íŠ¸, ì„ íƒ)
- ë„êµ¬ë³„ í”„ë¡¬í”„íŠ¸ (SystemMessage, HumanMessage)

### 3. ë„êµ¬ 2: ì›¹ ê²€ìƒ‰ ë„êµ¬ (`src/tools/web_search.py`)
- Langchain TavilySearchResults ë„êµ¬ ì—°ë™
- @tool ë°ì½”ë ˆì´í„°ë¡œ ì»¤ìŠ¤í…€ ì›¹ ê²€ìƒ‰ ë˜í¼ êµ¬í˜„
- ê²€ìƒ‰ ê²°ê³¼ í¬ë§·íŒ…

### 4. ë„êµ¬ 5: íŒŒì¼ ì €ì¥ ë„êµ¬ (`src/tools/file_save.py`)
- Langchain @tool ë°ì½”ë ˆì´í„°ë¡œ save_to_file êµ¬í˜„
- ëŒ€í™” ë‚´ìš© ì €ì¥
- ìš”ì•½ ë‚´ìš© ì €ì¥
- Streamlit ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì—°ë™

---

## UI ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

### 1. Streamlit UI ì›Œí¬í”Œë¡œìš°

```mermaid
graph TB
    A[ì‚¬ìš©ì ì ‘ì†] --> B[ì‚¬ì´ë“œë°”<br/>ë‚œì´ë„ ì„ íƒ]
    B --> C{Easy or Hard?}
    C -->|Easy| D1[Easy í”„ë¡¬í”„íŠ¸<br/>ì„ íƒ]
    C -->|Hard| D2[Hard í”„ë¡¬í”„íŠ¸<br/>ì„ íƒ]

    D1 --> E[ì±„íŒ… ì…ë ¥ì°½]
    D2 --> E

    E --> F[ì§ˆë¬¸ ì…ë ¥]
    F --> G[Agent<br/>ì‹¤í–‰]

    G --> H{ë„êµ¬ ì„ íƒ}
    H -->|RAG| I1[ë…¼ë¬¸ ê²€ìƒ‰]
    H -->|Web| I2[ì›¹ ê²€ìƒ‰]
    H -->|Glossary| I3[ìš©ì–´ ì„¤ëª…]
    H -->|ê¸°íƒ€| I4[ê¸°íƒ€ ë„êµ¬]

    I1 --> J[ë‹µë³€ ìƒì„±]
    I2 --> J
    I3 --> J
    I4 --> J

    J --> K[ì±„íŒ… í™”ë©´<br/>ë‹µë³€ í‘œì‹œ]
    K --> L{ê³„ì† ì§ˆë¬¸?}
    L -->|Yes| E
    L -->|No| M[âœ… ì¢…ë£Œ]

    style A fill:#81c784,stroke:#388e3c,color:#000
    style B fill:#90caf9,stroke:#1976d2,color:#000
    style C fill:#ba68c8,stroke:#7b1fa2
    style D1 fill:#ce93d8,stroke:#7b1fa2,color:#000
    style D2 fill:#ce93d8,stroke:#7b1fa2,color:#000
    style E fill:#64b5f6,stroke:#1976d2,color:#000
    style F fill:#64b5f6,stroke:#1976d2,color:#000
    style G fill:#ba68c8,stroke:#7b1fa2,color:#000
    style H fill:#ba68c8,stroke:#7b1fa2
    style I1 fill:#ce93d8,stroke:#7b1fa2,color:#000
    style I2 fill:#ce93d8,stroke:#7b1fa2,color:#000
    style I3 fill:#ce93d8,stroke:#7b1fa2,color:#000
    style I4 fill:#ce93d8,stroke:#7b1fa2,color:#000
    style J fill:#a5d6a7,stroke:#388e3c,color:#000
    style K fill:#66bb6a,stroke:#2e7d32,color:#000
    style L fill:#ba68c8,stroke:#7b1fa2
    style M fill:#66bb6a,stroke:#2e7d32,color:#000
```

### 2. í”„ë¡¬í”„íŠ¸ ì„ íƒ íë¦„

```mermaid
graph LR
    A[ì‚¬ìš©ì ì§ˆë¬¸] --> B{ë‚œì´ë„}

    B -->|Easy| C[Easy<br/>System Prompt]
    B -->|Hard| D[Hard<br/>System Prompt]

    C --> E1[ì‰¬ìš´ ìš©ì–´<br/>ì‹¤ìƒí™œ ë¹„ìœ ]
    D --> E2[ì „ë¬¸ ìš©ì–´<br/>ê¸°ìˆ  ì„¸ë¶€ì‚¬í•­]

    E1 --> F[RAG ì»¨í…ìŠ¤íŠ¸<br/>ì¶”ê°€]
    E2 --> F

    F --> G[ìµœì¢… í”„ë¡¬í”„íŠ¸<br/>êµ¬ì„±]
    G --> H[LLM í˜¸ì¶œ]
    H --> I[âœ… ë‹µë³€ ìƒì„±]

    style A fill:#90caf9,stroke:#1976d2,color:#000
    style B fill:#ba68c8,stroke:#7b1fa2
    style C fill:#ce93d8,stroke:#7b1fa2,color:#000
    style D fill:#ce93d8,stroke:#7b1fa2,color:#000
    style E1 fill:#ffcc80,stroke:#f57c00,color:#000
    style E2 fill:#ffab91,stroke:#e64a19,color:#000
    style F fill:#a5d6a7,stroke:#388e3c,color:#000
    style G fill:#81c784,stroke:#2e7d32,color:#000
    style H fill:#66bb6a,stroke:#2e7d32,color:#000
    style I fill:#66bb6a,stroke:#2e7d32,color:#000
```

---

## Streamlit UI êµ¬í˜„

### 1. ê¸°ë³¸ ì±„íŒ… ì¸í„°í˜ì´ìŠ¤

**íŒŒì¼ ê²½ë¡œ**: `ui/app.py`

**êµ¬í˜„ ë°©ë²•**:
1. Streamlit í˜ì´ì§€ ì„¤ì •
   - page_title, page_icon, layout ì„¤ì •
2. ì œëª© ë° ì„¤ëª… í‘œì‹œ
3. ì‚¬ì´ë“œë°”ì— ë‚œì´ë„ ì„ íƒ UI êµ¬í˜„
   - selectboxë¡œ Easy/Hard ëª¨ë“œ ì„ íƒ
   - ì‚¬ìš© ë°©ë²• ë° ì˜ˆì‹œ ì§ˆë¬¸ í‘œì‹œ
4. ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”
   - messages ë¦¬ìŠ¤íŠ¸ (ëŒ€í™” ì´ë ¥)
   - memory_manager (ChatMemoryManager ì¸ìŠ¤í„´ìŠ¤)
   - agent (LangGraph Agent)
5. ëŒ€í™” íˆìŠ¤í† ë¦¬ í‘œì‹œ
   - st.session_state.messagesë¥¼ ìˆœíšŒí•˜ë©° ê° ë©”ì‹œì§€ ì¶œë ¥
6. ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬
   - st.chat_input()ìœ¼ë¡œ ì§ˆë¬¸ ì…ë ¥
   - ì‚¬ìš©ì ë©”ì‹œì§€ë¥¼ messagesì— ì¶”ê°€í•˜ê³  í™”ë©´ì— í‘œì‹œ
7. AI ë‹µë³€ ìƒì„±
   - st.spinner()ë¡œ ë¡œë”© í‘œì‹œ
   - Agent.invoke()ë¡œ ë‹µë³€ ìƒì„± (question, difficulty, messages ì „ë‹¬)
   - ë‹µë³€ì„ messagesì— ì¶”ê°€í•˜ê³  í™”ë©´ì— í‘œì‹œ
   - ChatMemoryManagerì— ëŒ€í™” ë‚´ìš© ì €ì¥
8. ëŒ€í™” ì´ˆê¸°í™” ë²„íŠ¼ êµ¬í˜„
   - ë²„íŠ¼ í´ë¦­ ì‹œ messagesì™€ memory ì´ˆê¸°í™”
   - st.rerun()ìœ¼ë¡œ í™”ë©´ ìƒˆë¡œê³ ì¹¨

### ì˜ˆì œ ì½”ë“œ

```python
# ui/app.py

import os
from datetime import datetime
import streamlit as st
from src.agent.graph import create_agent_graph
from src.memory.chat_history import ChatMemoryManager
from src.utils.logger import Logger

# Logger ì´ˆê¸°í™”
today = datetime.now().strftime("%Y%m%d")
time_now = datetime.now().strftime("%H%M%S")
experiment_name = "ui_app"
log_dir = f"experiments/{today}/{today}_{time_now}_{experiment_name}"
os.makedirs(log_dir, exist_ok=True)
logger = Logger(log_path=f"{log_dir}/experiment.log")

# í˜ì´ì§€ ì„¤ì •
st.set_page_config(
    page_title="ë…¼ë¬¸ ë¦¬ë·° ì±—ë´‡",
    page_icon="ğŸ“š",
    layout="wide"
)

# ì œëª© ë° ì„¤ëª…
st.title("ğŸ“š ë…¼ë¬¸ ë¦¬ë·° ì±—ë´‡")
st.markdown("AI Agent + RAGë¥¼ í™œìš©í•œ ì§€ëŠ¥í˜• ë…¼ë¬¸ ê²€ìƒ‰ ë° ìš”ì•½ ì‹œìŠ¤í…œ")

# ì‚¬ì´ë“œë°” - ë‚œì´ë„ ì„ íƒ
with st.sidebar:
    st.header("ì„¤ì •")

    difficulty_mode = st.selectbox(
        "ë‹µë³€ ë‚œì´ë„",
        ["Easy ëª¨ë“œ (ì´ˆì‹¬ììš©)", "Hard ëª¨ë“œ (ì „ë¬¸ê°€ìš©)"]
    )

    difficulty = "easy" if "Easy" in difficulty_mode else "hard"

    st.markdown("---")
    st.markdown("### ì‚¬ìš© ë°©ë²•")
    st.markdown("""
    1. ë‚œì´ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”
    2. ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”
    3. AI Agentê°€ ìë™ìœ¼ë¡œ ì ì ˆí•œ ë„êµ¬ë¥¼ ì„ íƒí•©ë‹ˆë‹¤
    """)

    st.markdown("### ì˜ˆì‹œ ì§ˆë¬¸")
    st.markdown("""
    - Transformer ë…¼ë¬¸ ì„¤ëª…í•´ì¤˜
    - Attentionì´ ë­ì•¼?
    - BERT ë…¼ë¬¸ ìš”ì•½í•´ì¤˜
    - 2024ë…„ ìµœì‹  LLM ë…¼ë¬¸ì€?
    """)

# ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”
if "messages" not in st.session_state:
    st.session_state.messages = []

if "memory_manager" not in st.session_state:
    st.session_state.memory_manager = ChatMemoryManager()

if "agent" not in st.session_state:
    st.session_state.agent = create_agent_graph()

# ëŒ€í™” íˆìŠ¤í† ë¦¬ í‘œì‹œ
for message in st.session_state.messages:
    with st.chat_message(message["role"]):
        st.markdown(message["content"])

# ì‚¬ìš©ì ì…ë ¥
if prompt := st.chat_input("ë…¼ë¬¸ì— ëŒ€í•´ ì§ˆë¬¸í•´ì£¼ì„¸ìš”"):
    # ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
    st.session_state.messages.append({"role": "user", "content": prompt})
    logger.write(f"ì§ˆë¬¸: {prompt}")

    with st.chat_message("user"):
        st.markdown(prompt)

    # AI ë‹µë³€ ìƒì„±
    with st.chat_message("assistant"):
        with st.spinner("ë‹µë³€ ìƒì„± ì¤‘..."):
            # Agent ì‹¤í–‰
            response = st.session_state.agent.invoke({
                "question": prompt,
                "difficulty": difficulty,
                "messages": st.session_state.memory_manager.get_history()
            })

            answer = response.get("final_answer", "ë‹µë³€ì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
            logger.write(f"ë‹µë³€: {answer}")

            st.markdown(answer)

    # ë©”ì‹œì§€ ì¶”ê°€
    st.session_state.messages.append({"role": "assistant", "content": answer})

    # ë©”ëª¨ë¦¬ì— ì €ì¥
    st.session_state.memory_manager.add_user_message(prompt)
    st.session_state.memory_manager.add_ai_message(answer)

# ì‚¬ì´ë“œë°” - ëŒ€í™” ì´ˆê¸°í™”
with st.sidebar:
    st.markdown("---")
    if st.button("ëŒ€í™” ì´ˆê¸°í™”"):
        st.session_state.messages = []
        st.session_state.memory_manager.clear()
        st.rerun()
```

### 2. ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ (ê³ ê¸‰)

**íŒŒì¼ ê²½ë¡œ**: `ui/app_streaming.py`

**êµ¬í˜„ ë°©ë²•**:
1. StreamlitCallbackHandler ìƒì„±
   - st.container()ë¥¼ ì „ë‹¬í•˜ì—¬ ì´ˆê¸°í™”
2. ì‘ë‹µì„ í‘œì‹œí•  placeholder ìƒì„±
   - st.empty()ë¡œ ë¹ˆ ì»¨í…Œì´ë„ˆ ìƒì„±
3. Agent ìŠ¤íŠ¸ë¦¬ë° ì‹¤í–‰
   - agent.astream_events()ë¡œ ë¹„ë™ê¸° ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ ìƒì„±
   - question, difficulty ì „ë‹¬
4. ì´ë²¤íŠ¸ ì²˜ë¦¬
   - "on_chat_model_stream" ì´ë²¤íŠ¸ì—ì„œ ì²­í¬ ì¶”ì¶œ
   - ì²­í¬ë¥¼ full_responseì— ëˆ„ì 
   - placeholderì— ì‹¤ì‹œê°„ìœ¼ë¡œ ì‘ë‹µ ì—…ë°ì´íŠ¸ (ì»¤ì„œ íš¨ê³¼: "â–Œ")
5. ìµœì¢… ì‘ë‹µ í‘œì‹œ
   - ìŠ¤íŠ¸ë¦¬ë° ì™„ë£Œ í›„ ìµœì¢… ì‘ë‹µ í‘œì‹œ

### 3. íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥

**íŒŒì¼ ê²½ë¡œ**: `ui/app.py` (ì¶”ê°€ ê¸°ëŠ¥)

**êµ¬í˜„ ë°©ë²•**:
1. ì‚¬ì´ë“œë°”ì— íŒŒì¼ ì €ì¥ ì„¹ì…˜ ì¶”ê°€
2. "ëŒ€í™” ë‚´ìš© ì €ì¥" ë²„íŠ¼ êµ¬í˜„
3. ë²„íŠ¼ í´ë¦­ ì‹œ ì²˜ë¦¬
   - st.session_state.messagesë¥¼ ìˆœíšŒí•˜ë©° í…ìŠ¤íŠ¸ë¡œ ë³€í™˜
   - ê° ë©”ì‹œì§€ì˜ roleì— ë”°ë¼ "ì‚¬ìš©ì" ë˜ëŠ” "AI" ë ˆì´ë¸” ì¶”ê°€
4. íŒŒì¼ëª… ìƒì„±
   - datetime.now()ë¡œ í˜„ì¬ ì‹œê°„ ê¸°ë°˜ íŒŒì¼ëª… ìƒì„±
5. st.download_button() êµ¬í˜„
   - conversation_textë¥¼ ë°ì´í„°ë¡œ ì „ë‹¬
   - ìƒì„±ëœ íŒŒì¼ëª… ì‚¬ìš©
   - MIME íƒ€ì…: text/plain
6. ì„±ê³µ ë˜ëŠ” ê²½ê³  ë©”ì‹œì§€ í‘œì‹œ

---

## í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ êµ¬í˜„

### 1. Easy/Hard ëª¨ë“œ í”„ë¡¬í”„íŠ¸

**íŒŒì¼ ê²½ë¡œ**: `src/prompts/templates.py`

**êµ¬í˜„ ë°©ë²•**:
1. Langchain í”„ë¡¬í”„íŠ¸ ëª¨ë“ˆ ì„í¬íŠ¸
   - ChatPromptTemplate, SystemMessagePromptTemplate, HumanMessagePromptTemplate, PromptTemplate
2. Easy ëª¨ë“œ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì •ì˜
   - ì „ë¬¸ ìš©ì–´ë¥¼ ì‰¬ìš´ ë§ë¡œ ì„¤ëª…
   - ì‹¤ìƒí™œ ë¹„ìœ  ì‚¬ìš©
   - ìˆ˜ì‹ ìµœì†Œí™” ë° ì§ê´€ì  ì„¤ëª…
   - í•µì‹¬ ì•„ì´ë””ì–´ 3ê°€ì§€ ì´ë‚´ë¡œ ìš”ì•½
   - ì´ˆì‹¬ìë„ ì´í•´í•  ìˆ˜ ìˆëŠ” ì–¸ì–´ ì‚¬ìš©
3. Easy ëª¨ë“œ ChatPromptTemplate ìƒì„±
   - SystemMessageì™€ HumanMessage ì¡°í•©
4. Hard ëª¨ë“œ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì •ì˜
   - ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ ë° ìˆ˜ì‹ í¬í•¨
   - ì•Œê³ ë¦¬ì¦˜ì˜ ì‹œê°„/ê³µê°„ ë³µì¡ë„ ë¶„ì„
   - ê´€ë ¨ ë…¼ë¬¸ê³¼ì˜ ë¹„êµ (ì¥ë‹¨ì )
   - êµ¬í˜„ ì‹œ ê³ ë ¤ì‚¬í•­ ì„¤ëª…
   - ìµœì‹  ì—°êµ¬ ë™í–¥ê³¼ì˜ ì—°ê²°
5. Hard ëª¨ë“œ ChatPromptTemplate ìƒì„±
6. `get_difficulty_prompt` í•¨ìˆ˜ êµ¬í˜„
   - ë‚œì´ë„ì— ë”°ë¼ ì ì ˆí•œ í”„ë¡¬í”„íŠ¸ ë°˜í™˜

### 2. RAG í”„ë¡¬í”„íŠ¸

**êµ¬í˜„ ë°©ë²•**:
1. RAG_PROMPT_TEMPLATEì„ ChatPromptTemplateìœ¼ë¡œ ìƒì„±
2. SystemMessageì— ë‹¤ìŒ ê·œì¹™ í¬í•¨
   - ë…¼ë¬¸ ë¦¬ë·° ì „ë¬¸ê°€ ì—­í• 
   - ê²€ìƒ‰ ê²°ê³¼ì˜ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹µë³€
   - ì¶œì²˜ ëª…ì‹œ (ë…¼ë¬¸ ì œëª©, ì €ì)
   - ê²€ìƒ‰ ê²°ê³¼ì— ì—†ëŠ” ë‚´ìš©ì€ ì¶”ì¸¡í•˜ì§€ ì•ŠìŒ
   - ë‚œì´ë„ ëª¨ë“œ ë°˜ì˜
   - ê²€ìƒ‰ ê²°ê³¼(context) í¬í•¨
3. HumanMessageì— ì‚¬ìš©ì ì§ˆë¬¸ í¬í•¨

### 3. Few-Shot í”„ë¡¬í”„íŠ¸ (ì„ íƒ)

**êµ¬í˜„ ë°©ë²•**:
1. ì˜ˆì‹œ ë°ì´í„° ë¦¬ìŠ¤íŠ¸ ì •ì˜
   - Easy ëª¨ë“œ ì˜ˆì‹œ: "Transformerê°€ ë­ì•¼?" â†’ ì‰¬ìš´ ì„¤ëª…
   - Hard ëª¨ë“œ ì˜ˆì‹œ: "Transformerì˜ ì‹œê°„ ë³µì¡ë„ëŠ”?" â†’ ê¸°ìˆ ì  ì„¤ëª…
2. example_prompt ìƒì„±
   - PromptTemplateìœ¼ë¡œ question, difficulty, answer í¬í•¨
3. FewShotPromptTemplate ìƒì„±
   - examples: ì˜ˆì‹œ ë°ì´í„°
   - example_prompt: ì˜ˆì‹œ í¬ë§·
   - prefix: ë„ì… ë¬¸êµ¬
   - suffix: ì‹¤ì œ ì§ˆë¬¸ ë¶€ë¶„
   - input_variables: question, difficulty

### ì˜ˆì œ ì½”ë“œ

```python
# src/prompts/templates.py

from langchain.prompts import (
    ChatPromptTemplate,
    SystemMessagePromptTemplate,
    HumanMessagePromptTemplate,
    PromptTemplate
)

# Easy ëª¨ë“œ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
EASY_SYSTEM_PROMPT = """
ë‹¹ì‹ ì€ AI ì´ˆì‹¬ìë¥¼ ìœ„í•œ ì¹œì ˆí•œ ë…¼ë¬¸ ë¦¬ë·° ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

ë‹µë³€ ê·œì¹™:
1. ì „ë¬¸ ìš©ì–´ëŠ” ì‰¬ìš´ ë§ë¡œ í’€ì–´ì„œ ì„¤ëª…í•˜ì„¸ìš”
2. ì‹¤ìƒí™œ ë¹„ìœ ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
3. ìˆ˜ì‹ì€ ìµœì†Œí™”í•˜ê³  ì§ê´€ì ìœ¼ë¡œ ì„¤ëª…í•˜ì„¸ìš”
4. í•µì‹¬ ì•„ì´ë””ì–´ 3ê°€ì§€ ì´ë‚´ë¡œ ìš”ì•½í•˜ì„¸ìš”
5. ì´ˆì‹¬ìë„ ì´í•´í•  ìˆ˜ ìˆëŠ” ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
"""

# Hard ëª¨ë“œ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
HARD_SYSTEM_PROMPT = """
ë‹¹ì‹ ì€ AI ì „ë¬¸ê°€ë¥¼ ìœ„í•œ ê¸°ìˆ ì ì¸ ë…¼ë¬¸ ë¦¬ë·° ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

ë‹µë³€ ê·œì¹™:
1. ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ ë° ìˆ˜ì‹ì„ í¬í•¨í•˜ì„¸ìš”
2. ì•Œê³ ë¦¬ì¦˜ì˜ ì‹œê°„/ê³µê°„ ë³µì¡ë„ë¥¼ ë¶„ì„í•˜ì„¸ìš”
3. ê´€ë ¨ ë…¼ë¬¸ê³¼ì˜ ë¹„êµ (ì¥ë‹¨ì )ë¥¼ ì œì‹œí•˜ì„¸ìš”
4. êµ¬í˜„ ì‹œ ê³ ë ¤ì‚¬í•­ì„ ì„¤ëª…í•˜ì„¸ìš”
5. ìµœì‹  ì—°êµ¬ ë™í–¥ê³¼ì˜ ì—°ê²°ì„ ì œê³µí•˜ì„¸ìš”
"""

# Easy ëª¨ë“œ ChatPromptTemplate
EASY_CHAT_PROMPT = ChatPromptTemplate.from_messages([
    SystemMessagePromptTemplate.from_template(EASY_SYSTEM_PROMPT),
    HumanMessagePromptTemplate.from_template("{question}")
])

# Hard ëª¨ë“œ ChatPromptTemplate
HARD_CHAT_PROMPT = ChatPromptTemplate.from_messages([
    SystemMessagePromptTemplate.from_template(HARD_SYSTEM_PROMPT),
    HumanMessagePromptTemplate.from_template("{question}")
])

# RAG í”„ë¡¬í”„íŠ¸
RAG_PROMPT_TEMPLATE = """
ë‹¹ì‹ ì€ ë…¼ë¬¸ ë¦¬ë·° ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

ì•„ë˜ ë…¼ë¬¸ ë‚´ìš©ì„ ì°¸ê³ í•˜ì—¬ ì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”.

[ì°¸ê³  ë…¼ë¬¸]
{context}

[ì‚¬ìš©ì ì§ˆë¬¸]
{question}

[ë‹µë³€ ê·œì¹™]
- ì°¸ê³  ë…¼ë¬¸ì˜ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”
- ì¶œì²˜ë¥¼ ëª…ì‹œí•˜ì„¸ìš” (ë…¼ë¬¸ ì œëª©, ì €ì)
- ë…¼ë¬¸ì— ì—†ëŠ” ë‚´ìš©ì€ ì¶”ì¸¡í•˜ì§€ ë§ˆì„¸ìš”
- ë‚œì´ë„: {difficulty} ëª¨ë“œ

ë‹µë³€:
"""

RAG_CHAT_PROMPT = ChatPromptTemplate.from_template(RAG_PROMPT_TEMPLATE)

def get_difficulty_prompt(difficulty):
    """ë‚œì´ë„ì— ë”°ë¼ ì ì ˆí•œ í”„ë¡¬í”„íŠ¸ ë°˜í™˜"""
    if difficulty == "easy":
        return EASY_CHAT_PROMPT
    else:
        return HARD_CHAT_PROMPT
```

---

## ë„êµ¬ 2: ì›¹ ê²€ìƒ‰ ë„êµ¬

### ê¸°ëŠ¥ ì„¤ëª…
ìµœì‹  ë…¼ë¬¸ ì •ë³´ë¥¼ ì›¹ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ê²€ìƒ‰í•˜ëŠ” ë„êµ¬

### Langchain êµ¬í˜„

#### 1. TavilySearchResults ì—°ë™

**íŒŒì¼ ê²½ë¡œ**: `src/tools/web_search.py`

**êµ¬í˜„ ë°©ë²•**:
1. TavilySearchResults ì´ˆê¸°í™”
   - max_results: 5
   - search_depth: "advanced"
   - include_answer: True
   - include_raw_content: False
   - API í‚¤ë¥¼ í™˜ê²½ë³€ìˆ˜ì—ì„œ ë¡œë“œ
2. `search_latest_papers` í•¨ìˆ˜ë¥¼ @tool ë°ì½”ë ˆì´í„°ë¡œ ì •ì˜
   - ì¸ì: query (ê²€ìƒ‰ ì§ˆë¬¸)
   - ê²€ìƒ‰ ì¿¼ë¦¬ í™•ì¥ (AI ML paper 2024 2025 arxiv ì¶”ê°€)
   - tavily_search.invoke()ë¡œ ê²€ìƒ‰ ìˆ˜í–‰
3. `format_web_search_results` í•¨ìˆ˜ êµ¬í˜„
   - ê²€ìƒ‰ ê²°ê³¼ë¥¼ Markdown í˜•ì‹ìœ¼ë¡œ í¬ë§·íŒ…
   - ê° ê²°ê³¼ì˜ title, url, content í¬í•¨
   - ê²°ê³¼ê°€ ì—†ìœ¼ë©´ "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤." ë°˜í™˜

#### 2. arXiv ê²€ìƒ‰ (ì„ íƒ)

**êµ¬í˜„ ë°©ë²•**:
1. `search_arxiv` í•¨ìˆ˜ë¥¼ @tool ë°ì½”ë ˆì´í„°ë¡œ ì •ì˜
   - ì¸ì: query, max_docs
2. ArxivLoaderë¡œ ê²€ìƒ‰ ìˆ˜í–‰
   - queryì™€ max_docs ì „ë‹¬
   - load()ë¡œ ë¬¸ì„œ ë¡œë“œ
3. ê²°ê³¼ í¬ë§·íŒ…
   - ê° ë¬¸ì„œì˜ Title, Authors, Published ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
   - page_contentì—ì„œ ìš”ì•½ 500ì ì¶”ì¶œ
   - Markdown í˜•ì‹ìœ¼ë¡œ í¬ë§·íŒ…

### ì‚¬ìš©í•˜ëŠ” DB
**DB ì‚¬ìš© ì—†ìŒ** (ì™¸ë¶€ API í˜¸ì¶œ)

### ì˜ˆì œ ì½”ë“œ

```python
# src/tools/web_search.py

from langchain.tools import tool
from langchain_community.tools.tavily_search import TavilySearchResults
import os

# Tavily Search API ì´ˆê¸°í™”
tavily_search = TavilySearchResults(
    max_results=5,
    search_depth="advanced",
    include_answer=True,
    include_raw_content=False,
    api_key=os.getenv("TAVILY_API_KEY")
)

@tool
def search_latest_papers(query: str) -> str:
    """
    ì›¹ì—ì„œ ìµœì‹  ë…¼ë¬¸ ì •ë³´ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.

    Args:
        query: ê²€ìƒ‰ ì§ˆë¬¸

    Returns:
        ê²€ìƒ‰ ê²°ê³¼ (Markdown í˜•ì‹)
    """
    # ê²€ìƒ‰ ì¿¼ë¦¬ í™•ì¥ (ë…¼ë¬¸ ê²€ìƒ‰ì— íŠ¹í™”)
    enhanced_query = f"{query} AI ML paper 2024 2025 arxiv"

    # Tavily ê²€ìƒ‰ ì‹¤í–‰
    results = tavily_search.invoke(enhanced_query)

    # ê²°ê³¼ í¬ë§·íŒ…
    return format_web_search_results(results)


def format_web_search_results(results):
    """ê²€ìƒ‰ ê²°ê³¼ë¥¼ Markdown í˜•ì‹ìœ¼ë¡œ í¬ë§·íŒ…"""
    if not results:
        return "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤."

    formatted = "## ì›¹ ê²€ìƒ‰ ê²°ê³¼\n\n"

    for i, result in enumerate(results, 1):
        formatted += f"### {i}. {result.get('title', 'ì œëª© ì—†ìŒ')}\n"
        formatted += f"- **URL**: {result.get('url', '')}\n"
        formatted += f"{result.get('content', '')[:300]}...\n\n"
        formatted += "---\n\n"

    return formatted


# arXiv ê²€ìƒ‰ (ì„ íƒ)
from langchain.document_loaders import ArxivLoader

@tool
def search_arxiv(query: str, max_docs: int = 5) -> str:
    """
    arXivì—ì„œ ë…¼ë¬¸ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤.

    Args:
        query: ê²€ìƒ‰ ì§ˆë¬¸
        max_docs: ìµœëŒ€ ê²€ìƒ‰ ë…¼ë¬¸ ìˆ˜

    Returns:
        ê²€ìƒ‰ ê²°ê³¼ (Markdown í˜•ì‹)
    """
    # ArxivLoaderë¡œ ê²€ìƒ‰
    loader = ArxivLoader(query=query, load_max_docs=max_docs)
    docs = loader.load()

    if not docs:
        return "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤."

    formatted = "## arXiv ê²€ìƒ‰ ê²°ê³¼\n\n"

    for i, doc in enumerate(docs, 1):
        title = doc.metadata.get('Title', 'ì œëª© ì—†ìŒ')
        authors = doc.metadata.get('Authors', 'ì €ì ì—†ìŒ')
        published = doc.metadata.get('Published', '')

        formatted += f"### {i}. {title}\n"
        formatted += f"- **ì €ì**: {authors}\n"
        formatted += f"- **ì¶œíŒì¼**: {published}\n"
        formatted += f"{doc.page_content[:500]}...\n\n"
        formatted += "---\n\n"

    return formatted
```

---

## ë„êµ¬ 5: íŒŒì¼ ì €ì¥ ë„êµ¬

### ê¸°ëŠ¥ ì„¤ëª…
ëŒ€í™” ë‚´ìš©, ë…¼ë¬¸ ìš”ì•½, ì°¸ê³  ìë£Œë¥¼ íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ë„êµ¬

### Langchain êµ¬í˜„

#### 1. í…ìŠ¤íŠ¸ íŒŒì¼ ì €ì¥

**íŒŒì¼ ê²½ë¡œ**: `src/tools/file_save.py`

**êµ¬í˜„ ë°©ë²•**:
1. `save_to_file` í•¨ìˆ˜ë¥¼ @tool ë°ì½”ë ˆì´í„°ë¡œ ì •ì˜
   - ì¸ì: content (ì €ì¥í•  ë‚´ìš©), filename (ì„ íƒì )
2. íŒŒì¼ëª…ì´ ì—†ìœ¼ë©´ íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ìœ¼ë¡œ ìë™ ìƒì„±
3. output_dir (data/outputs) ìƒì„±
4. íŒŒì¼ ê²½ë¡œ ìƒì„± ë° íŒŒì¼ ì €ì¥
5. ì €ì¥ ì„±ê³µ ë©”ì‹œì§€ ë°˜í™˜

#### 2. Markdown í˜•ì‹ ì €ì¥

**êµ¬í˜„ ë°©ë²•**:
1. `save_to_markdown` í•¨ìˆ˜ë¥¼ @tool ë°ì½”ë ˆì´í„°ë¡œ ì •ì˜
   - ì¸ì: content, title, filename (ì„ íƒì )
2. íŒŒì¼ëª…ì´ ì—†ìœ¼ë©´ íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ìœ¼ë¡œ ìë™ ìƒì„±
3. Markdown í˜•ì‹ìœ¼ë¡œ content í¬ë§·íŒ…
   - ì œëª©, ìƒì„±ì¼, ë‚´ìš©, í‘¸í„° í¬í•¨
4. output_dir ìƒì„± ë° íŒŒì¼ ì €ì¥
5. ì €ì¥ ì„±ê³µ ë©”ì‹œì§€ ë°˜í™˜

#### 3. Streamlit ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì—°ë™

**íŒŒì¼ ê²½ë¡œ**: `ui/app.py` (íŒŒì¼ ì €ì¥ UI)

**êµ¬í˜„ ë°©ë²•**:
1. ì‚¬ì´ë“œë°”ì— íŒŒì¼ ì €ì¥ ì„¹ì…˜ ì¶”ê°€
2. st.radio()ë¡œ ì €ì¥ ë‚´ìš© ì„ íƒ ("ëŒ€í™” ë‚´ìš©" ë˜ëŠ” "ë§ˆì§€ë§‰ ë‹µë³€ë§Œ")
3. "íŒŒì¼ ì €ì¥" ë²„íŠ¼ êµ¬í˜„
4. ì„ íƒëœ ì˜µì…˜ì— ë”°ë¼ content ìƒì„±
   - "ëŒ€í™” ë‚´ìš©": ì „ì²´ messagesë¥¼ ìˆœíšŒí•˜ë©° í…ìŠ¤íŠ¸ ìƒì„±
   - "ë§ˆì§€ë§‰ ë‹µë³€ë§Œ": assistant ì—­í• ì˜ ë§ˆì§€ë§‰ ë©”ì‹œì§€ ì¶”ì¶œ
5. save_to_file.invoke()ë¡œ íŒŒì¼ ì €ì¥
6. st.download_button()ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ìƒì„±
   - íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ íŒŒì¼ëª…
   - MIME íƒ€ì…: text/plain

### ì‚¬ìš©í•˜ëŠ” DB
**DB ì‚¬ìš© ì—†ìŒ** (íŒŒì¼ ì‹œìŠ¤í…œ ì§ì ‘ ì ‘ê·¼)

### ì˜ˆì œ ì½”ë“œ

```python
# src/tools/file_save.py

from langchain.tools import tool
import os
from datetime import datetime

@tool
def save_to_file(content: str, filename: str = None) -> str:
    """
    ë‚´ìš©ì„ í…ìŠ¤íŠ¸ íŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

    Args:
        content: ì €ì¥í•  ë‚´ìš©
        filename: íŒŒì¼ëª… (ì„ íƒ, ì—†ìœ¼ë©´ ìë™ ìƒì„±)

    Returns:
        ì €ì¥ëœ íŒŒì¼ ê²½ë¡œ
    """
    # íŒŒì¼ëª…ì´ ì—†ìœ¼ë©´ íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ìœ¼ë¡œ ìë™ ìƒì„±
    if filename is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        filename = f"paper_review_{timestamp}.txt"

    # data/outputs í´ë”ì— ì €ì¥
    output_dir = "data/outputs"
    os.makedirs(output_dir, exist_ok=True)

    filepath = os.path.join(output_dir, filename)

    # íŒŒì¼ ì €ì¥
    with open(filepath, "w", encoding="utf-8") as f:
        f.write(content)

    return f"íŒŒì¼ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤: {filepath}"


@tool
def save_to_markdown(content: str, title: str = "ë…¼ë¬¸ ë¦¬ë·°", filename: str = None) -> str:
    """
    ë‚´ìš©ì„ Markdown í˜•ì‹ìœ¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.

    Args:
        content: ì €ì¥í•  ë‚´ìš©
        title: ë¬¸ì„œ ì œëª©
        filename: íŒŒì¼ëª… (ì„ íƒ, ì—†ìœ¼ë©´ ìë™ ìƒì„±)

    Returns:
        ì €ì¥ëœ íŒŒì¼ ê²½ë¡œ
    """
    # íŒŒì¼ëª…ì´ ì—†ìœ¼ë©´ íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ìœ¼ë¡œ ìë™ ìƒì„±
    if filename is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        filename = f"paper_review_{timestamp}.md"

    # Markdown í˜•ì‹ìœ¼ë¡œ í¬ë§·íŒ…
    markdown_content = f"# {title}\n\n"
    markdown_content += f"**ìƒì„±ì¼**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n\n"
    markdown_content += "---\n\n"
    markdown_content += content
    markdown_content += "\n\n---\n\n"
    markdown_content += "*ì´ ë¬¸ì„œëŠ” ë…¼ë¬¸ ë¦¬ë·° ì±—ë´‡ì—ì„œ ìë™ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.*\n"

    # data/outputs í´ë”ì— ì €ì¥
    output_dir = "data/outputs"
    os.makedirs(output_dir, exist_ok=True)

    filepath = os.path.join(output_dir, filename)

    # íŒŒì¼ ì €ì¥
    with open(filepath, "w", encoding="utf-8") as f:
        f.write(markdown_content)

    return f"Markdown íŒŒì¼ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤: {filepath}"


# Streamlit UIì™€ ì—°ë™ (ui/app.pyì— ì¶”ê°€)
def add_file_download_to_sidebar():
    """ì‚¬ì´ë“œë°”ì— íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ ì¶”ê°€"""
    import streamlit as st

    with st.sidebar:
        st.markdown("---")
        st.markdown("### íŒŒì¼ ì €ì¥")

        # ì €ì¥ ë‚´ìš© ì„ íƒ
        save_option = st.radio(
            "ì €ì¥í•  ë‚´ìš©",
            ["ëŒ€í™” ë‚´ìš©", "ë§ˆì§€ë§‰ ë‹µë³€ë§Œ"]
        )

        if st.button("íŒŒì¼ ì €ì¥"):
            # ëŒ€í™” ë‚´ìš© í…ìŠ¤íŠ¸ë¡œ ë³€í™˜
            if save_option == "ëŒ€í™” ë‚´ìš©":
                conversation_text = ""
                for msg in st.session_state.messages:
                    role = "ì‚¬ìš©ì" if msg["role"] == "user" else "AI"
                    conversation_text += f"[{role}]\n{msg['content']}\n\n"

                content = conversation_text
            else:
                # ë§ˆì§€ë§‰ assistant ë©”ì‹œì§€ ì°¾ê¸°
                last_assistant_msg = None
                for msg in reversed(st.session_state.messages):
                    if msg["role"] == "assistant":
                        last_assistant_msg = msg["content"]
                        break

                content = last_assistant_msg if last_assistant_msg else "ì €ì¥í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤."

            # íŒŒì¼ëª… ìƒì„±
            timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
            filename = f"conversation_{timestamp}.txt"

            # st.download_buttonìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ ì œê³µ
            st.download_button(
                label="ë‹¤ìš´ë¡œë“œ",
                data=content,
                file_name=filename,
                mime="text/plain"
            )

            st.success("ë‹¤ìš´ë¡œë“œ ì¤€ë¹„ ì™„ë£Œ!")
```

---

## LangGraph í†µí•© (ì›¹ ê²€ìƒ‰/íŒŒì¼ ì €ì¥ ë…¸ë“œ)

**íŒŒì¼ ê²½ë¡œ**: `src/agent/nodes.py`

### 1. ì›¹ ê²€ìƒ‰ ë…¸ë“œ

**êµ¬í˜„ ë°©ë²•**:
1. `web_search_node` í•¨ìˆ˜ ì •ì˜
   - ì¸ì: state (AgentState)
2. stateì—ì„œ ì§ˆë¬¸ ì¶”ì¶œ
3. ì›¹ ê²€ìƒ‰ ë„êµ¬ í˜¸ì¶œ
   - search_latest_papers.invoke()ë¡œ ê²€ìƒ‰ ìˆ˜í–‰
4. ê²€ìƒ‰ ê²°ê³¼ë¥¼ state["tool_result"]ì— ì €ì¥
5. í”„ë¡¬í”„íŠ¸ êµ¬ì„±
   - ê²€ìƒ‰ ê²°ê³¼ì™€ ì‚¬ìš©ì ì§ˆë¬¸ í¬í•¨
6. LLM í˜¸ì¶œí•˜ì—¬ ìµœì¢… ë‹µë³€ ìƒì„±
   - SystemMessage: "ë‹¹ì‹ ì€ ìµœì‹  AI/ML ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤."
   - HumanMessage: í”„ë¡¬í”„íŠ¸
7. ìµœì¢… ë‹µë³€ì„ state["final_answer"]ì— ì €ì¥ í›„ ë°˜í™˜

### 2. íŒŒì¼ ì €ì¥ ë…¸ë“œ

**êµ¬í˜„ ë°©ë²•**:
1. `save_file_node` í•¨ìˆ˜ ì •ì˜
   - ì¸ì: state (AgentState)
2. stateì—ì„œ ì´ì „ ë‹µë³€(final_answer) ì¶”ì¶œ
3. ë‹µë³€ì´ ìˆìœ¼ë©´ íŒŒì¼ ì €ì¥ ë„êµ¬ í˜¸ì¶œ
   - save_to_file.invoke()ë¡œ ì €ì¥ ìˆ˜í–‰
   - ì €ì¥ ê²°ê³¼ë¥¼ state["final_answer"]ì— ì €ì¥
4. ë‹µë³€ì´ ì—†ìœ¼ë©´ "ì €ì¥í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤." ë©”ì‹œì§€ ë°˜í™˜
5. state ë°˜í™˜

---

## ê°œë°œ ì¼ì •

### Phase 1: Streamlit UI ê¸°ì´ˆ ê°œë°œ
- ê¸°ë³¸ ì±„íŒ… ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
- ë‚œì´ë„ ì„ íƒ UI
- ëŒ€í™” íˆìŠ¤í† ë¦¬ í‘œì‹œ
- StreamlitCallbackHandler ì—°ë™

### Phase 2: í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ê°œë°œ
- Easy/Hard ëª¨ë“œ í”„ë¡¬í”„íŠ¸
- RAG í”„ë¡¬í”„íŠ¸
- FewShotPromptTemplate (ì„ íƒ)

### Phase 3: ë„êµ¬ ê°œë°œ
- ì›¹ ê²€ìƒ‰ ë„êµ¬ (TavilySearchResults)
- íŒŒì¼ ì €ì¥ ë„êµ¬
- Streamlit ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì—°ë™

### Phase 4: ìŠ¤íŠ¸ë¦¬ë° ë° ìµœì í™”
- ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ êµ¬í˜„
- UI ë””ìì¸ ê°œì„ 
- í†µí•© í…ŒìŠ¤íŠ¸

---

## Feature ë¸Œëœì¹˜

- `feature/streamlit-ui` - Streamlit UI
- `feature/prompts` - í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
- `feature/tool-web-search` - ì›¹ ê²€ìƒ‰ ë„êµ¬
- `feature/tool-file-save` - íŒŒì¼ ì €ì¥ ë„êµ¬

---

## í…ŒìŠ¤íŠ¸ ì½”ë“œ

**íŒŒì¼ ê²½ë¡œ**: `tests/test_tools.py`

### í…ŒìŠ¤íŠ¸ í•­ëª©

1. **test_web_search**: ì›¹ ê²€ìƒ‰ ë„êµ¬ í…ŒìŠ¤íŠ¸
   - search_latest_papers.invoke() í˜¸ì¶œ (query: "transformer 2025")
   - ë°˜í™˜ ê²°ê³¼ì— "ê²€ìƒ‰ ê²°ê³¼" í…ìŠ¤íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
   - ê²°ê³¼ê°€ ë¹„ì–´ìˆì§€ ì•Šì€ì§€ í™•ì¸

2. **test_file_save**: íŒŒì¼ ì €ì¥ ë„êµ¬ í…ŒìŠ¤íŠ¸
   - save_to_file.invoke() í˜¸ì¶œ (content: "í…ŒìŠ¤íŠ¸ ë‚´ìš©ì…ë‹ˆë‹¤.", filename: "test_file.txt")
   - ë°˜í™˜ ê²°ê³¼ì— "ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤" í…ìŠ¤íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
   - íŒŒì¼ì´ ì‹¤ì œë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸ (data/outputs/test_file.txt)

---

## ë¡œê¹… ë° ì‹¤í—˜ ì¶”ì  ê´€ë¦¬

### ë¡œê¹… ì‹œìŠ¤í…œ ì‚¬ìš©

**ì¤‘ìš”**: ëª¨ë“  ì¶œë ¥ì€ Logger í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

**íŒŒì¼ ê²½ë¡œ**: `src/utils/logger.py`

**ì‚¬ìš© ë°©ë²•**:
1. Logger ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
   - ì‹¤í—˜ í´ë” ìƒì„± ë° Logger ì´ˆê¸°í™”
   ```python
   import os
   from datetime import datetime
   from src.utils.logger import Logger

   # ì‹¤í—˜ í´ë” ìƒì„±
   today = datetime.now().strftime("%Y%m%d")
   time_now = datetime.now().strftime("%H%M%S")
   experiment_name = "ui_app"  # ë˜ëŠ” "ui_test" ë“±
   log_dir = f"experiments/{today}/{today}_{time_now}_{experiment_name}"
   os.makedirs(log_dir, exist_ok=True)

   # Logger ì´ˆê¸°í™”
   logger = Logger(log_path=f"{log_dir}/experiment.log")
   ```

2. ë¡œê·¸ ê¸°ë¡
   - Streamlitì—ì„œ st.write() ì™¸ì— logger.write()ë¡œ ë¡œê·¸ ê¸°ë¡
   - ì˜ˆ: `logger.write(f"ì§ˆë¬¸: {prompt}")`

3. ì‹¤í—˜ ì¢…ë£Œ
   - `logger.close()` í•„ìˆ˜ í˜¸ì¶œ

### ì‹¤í—˜ í´ë” êµ¬ì¡°

PRD ë¬¸ì„œ 06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md ì°¸ì¡°

---

## ì°¸ê³  PRD ë¬¸ì„œ

ê°œë°œ ì‹œ ë°˜ë“œì‹œ ì°¸ê³ í•´ì•¼ í•  PRD ë¬¸ì„œ ëª©ë¡:

### í•„ìˆ˜ ì°¸ê³  ë¬¸ì„œ
1. [01_í”„ë¡œì íŠ¸_ê°œìš”.md](../PRD/01_í”„ë¡œì íŠ¸_ê°œìš”.md) - í”„ë¡œì íŠ¸ ì „ì²´ ê°œìš”
2. [02_í”„ë¡œì íŠ¸_êµ¬ì¡°.md](../PRD/02_í”„ë¡œì íŠ¸_êµ¬ì¡°.md) - í´ë” êµ¬ì¡° (ui/)
3. [05_ë¡œê¹…_ì‹œìŠ¤í…œ.md](../PRD/05_ë¡œê¹…_ì‹œìŠ¤í…œ.md) â­ - Logger ì‚¬ìš©ë²•
4. [06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md](../PRD/06_ì‹¤í—˜_ì¶”ì _ê´€ë¦¬.md) â­ - ì‹¤í—˜ í´ë” êµ¬ì¡°
5. [14_LLM_ì„¤ì •.md](../PRD/14_LLM_ì„¤ì •.md) - LLM ì„ íƒ ë° ì—ëŸ¬ í•¸ë“¤ë§
6. [15_í”„ë¡¬í”„íŠ¸_ì—”ì§€ë‹ˆì–´ë§.md](../PRD/15_í”„ë¡¬í”„íŠ¸_ì—”ì§€ë‹ˆì–´ë§.md) - Easy/Hard í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
7. [16_UI_ì„¤ê³„.md](../PRD/16_UI_ì„¤ê³„.md) - Streamlit êµ¬í˜„ ê°€ì´ë“œ

### ì°¸ê³  ë¬¸ì„œ
- [03_ë¸Œëœì¹˜_ì „ëµ.md](../PRD/03_ë¸Œëœì¹˜_ì „ëµ.md) - Feature ë¸Œëœì¹˜
- [04_ì¼ì •_ê´€ë¦¬.md](../PRD/04_ì¼ì •_ê´€ë¦¬.md) - ê°œë°œ ì¼ì •
- [12_AI_Agent_ì„¤ê³„.md](../PRD/12_AI_Agent_ì„¤ê³„.md) - Agent ì—°ë™

---

## ì°¸ê³  ìë£Œ

- Streamlit ê³µì‹ ë¬¸ì„œ: https://docs.streamlit.io/
- Streamlit Chat Elements: https://docs.streamlit.io/library/api-reference/chat
- Langchain Prompts: https://python.langchain.com/docs/modules/model_io/prompts/
- Langchain Callbacks: https://python.langchain.com/docs/modules/callbacks/
- TavilySearchResults: https://python.langchain.com/docs/integrations/tools/tavily_search/
- StreamlitCallbackHandler: https://python.langchain.com/docs/integrations/callbacks/streamlit

