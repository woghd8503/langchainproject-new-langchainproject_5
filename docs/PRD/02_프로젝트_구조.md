# 02. í”„ë¡œì íŠ¸ êµ¬ì¡°

## ë¬¸ì„œ ì •ë³´
- **ì‘ì„±ì¼**: 2025-10-30
- **í”„ë¡œì íŠ¸ëª…**: ë…¼ë¬¸ ë¦¬ë·° ì±—ë´‡ (AI Agent + RAG)
- **íŒ€ëª…**: ì—°ê²°ì˜ ë¯¼ì¡±
- **ì‘ì„±ì**: ì—°ê²°ì˜ ë¯¼ì¡± íŒ€

---

## 1. ë””ë ‰í† ë¦¬ êµ¬ì¡°

### 1.1 ì „ì²´ êµ¬ì¡°

```
langchain-project/
â”œâ”€â”€ README.md                      # í”„ë¡œì íŠ¸ ì†Œê°œ ë° ì‚¬ìš© ë°©ë²•
â”œâ”€â”€ requirements.txt               # Python íŒ¨í‚¤ì§€ ì˜ì¡´ì„±
â”œâ”€â”€ .env.example                   # í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â”œâ”€â”€ .gitignore                     # Git ë¬´ì‹œ íŒŒì¼
â”‚
â”œâ”€â”€ main.py                        # ì• í”Œë¦¬ì¼€ì´ì…˜ ì—”íŠ¸ë¦¬ í¬ì¸íŠ¸
â”‚
â”œâ”€â”€ configs/                       # ì„¤ì • íŒŒì¼
â”‚   â”œâ”€â”€ db_config.yaml            # ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
â”‚   â”œâ”€â”€ model_config.yaml         # LLM ëª¨ë¸ ì„¤ì •
â”‚   â””â”€â”€ prompt_config.yaml        # í”„ë¡¬í”„íŠ¸ ì„¤ì •
â”‚
â”œâ”€â”€ src/                           # ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ agent/                     # AI Agent (LangGraph)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ graph.py              # LangGraph StateGraph ì •ì˜
â”‚   â”‚   â”œâ”€â”€ nodes.py              # ë…¸ë“œ í•¨ìˆ˜ë“¤
â”‚   â”‚   â”œâ”€â”€ state.py              # AgentState TypedDict
â”‚   â”‚   â””â”€â”€ router.py             # ë¼ìš°íŒ… ë¡œì§
â”‚   â”‚
â”‚   â”œâ”€â”€ tools/                     # ë„êµ¬ ëª¨ìŒ (6ê°œ)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ general.py            # ì¼ë°˜ ë‹µë³€ ë„êµ¬
â”‚   â”‚   â”œâ”€â”€ rag_search.py         # RAG ê²€ìƒ‰ ë„êµ¬
â”‚   â”‚   â”œâ”€â”€ web_search.py         # ì›¹ ê²€ìƒ‰ ë„êµ¬ (Tavily)
â”‚   â”‚   â”œâ”€â”€ glossary.py           # ìš©ì–´ì§‘ ë„êµ¬
â”‚   â”‚   â”œâ”€â”€ summarize.py          # ë…¼ë¬¸ ìš”ì•½ ë„êµ¬
â”‚   â”‚   â””â”€â”€ file_save.py          # íŒŒì¼ ì €ì¥ ë„êµ¬
â”‚   â”‚
â”‚   â”œâ”€â”€ rag/                       # RAG ì‹œìŠ¤í…œ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ retriever.py          # ë¬¸ì„œ ê²€ìƒ‰ (Retriever)
â”‚   â”‚   â”œâ”€â”€ embeddings.py         # ì„ë² ë”© ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ vector_store.py       # PGVector ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â””â”€â”€ reranker.py           # ì¬ìˆœìœ„í™” (ì„ íƒ)
â”‚   â”‚
â”‚   â”œâ”€â”€ llm/                       # LLM í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ client.py             # ChatOpenAI ë˜í¼
â”‚   â”‚   â””â”€â”€ config.py             # LLM ì„¤ì •
â”‚   â”‚
â”‚   â”œâ”€â”€ prompts/                   # í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ templates.py          # PromptTemplate ì •ì˜
â”‚   â”‚   â”œâ”€â”€ easy_mode.py          # Easy ëª¨ë“œ í”„ë¡¬í”„íŠ¸
â”‚   â”‚   â””â”€â”€ hard_mode.py          # Hard ëª¨ë“œ í”„ë¡¬í”„íŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ memory/                    # ëŒ€í™” ë©”ëª¨ë¦¬
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ chat_history.py       # ConversationBufferMemory
â”‚   â”‚
â”‚   â”œâ”€â”€ data/                      # ë°ì´í„° ì²˜ë¦¬
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ document_loader.py    # Document Loader
â”‚   â”‚   â”œâ”€â”€ text_splitter.py      # RecursiveCharacterTextSplitter
â”‚   â”‚   â””â”€â”€ embedder.py           # ì„ë² ë”© ìƒì„±
â”‚   â”‚
â”‚   â”œâ”€â”€ text2sql/                  # Text-to-SQL (ì„ íƒ)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ sql_generator.py      # SQL ì¿¼ë¦¬ ìƒì„±
â”‚   â”‚
â”‚   â”œâ”€â”€ evaluation/                # ì„±ëŠ¥ í‰ê°€ (ì„ íƒ)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ rag_evaluator.py      # RAG í‰ê°€
â”‚   â”‚   â””â”€â”€ metrics.py            # í‰ê°€ ë©”íŠ¸ë¦­
â”‚   â”‚
â”‚   â””â”€â”€ utils/                     # ìœ í‹¸ë¦¬í‹°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ logger.py             # Logger í´ë˜ìŠ¤
â”‚       â”œâ”€â”€ db.py                 # PostgreSQL ìœ í‹¸ë¦¬í‹°
â”‚       â””â”€â”€ config_loader.py      # YAML ì„¤ì • ë¡œë”
â”‚
â”œâ”€â”€ ui/                            # Streamlit UI
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ app.py                    # ë©”ì¸ UI
â”‚   â”œâ”€â”€ components/               # UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ chat_interface.py    # ì±„íŒ… ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ sidebar.py           # ì‚¬ì´ë“œë°” (ë‚œì´ë„ ì„ íƒ ë“±)
â”‚   â”‚   â””â”€â”€ file_download.py     # íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼
â”‚   â””â”€â”€ styles.css                # ì»¤ìŠ¤í…€ CSS
â”‚
â”œâ”€â”€ data/                          # ë°ì´í„° ì €ì¥ì†Œ
â”‚   â”œâ”€â”€ raw/                      # ì›ë³¸ ë°ì´í„°
â”‚   â”‚   â”œâ”€â”€ pdfs/                # ë…¼ë¬¸ PDF íŒŒì¼
â”‚   â”‚   â”œâ”€â”€ json/                # ë©”íƒ€ë°ì´í„° JSON
â”‚   â”‚   â””â”€â”€ txt/                 # ì¶”ì¶œëœ í…ìŠ¤íŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ processed/                # ì „ì²˜ë¦¬ëœ ë°ì´í„°
â”‚   â”‚   â”œâ”€â”€ chunks/              # ì²­í¬ ë¶„í•  ë°ì´í„°
â”‚   â”‚   â””â”€â”€ embeddings/          # ì„ë² ë”© ë²¡í„° (ìºì‹œ)
â”‚   â”‚
â”‚   â””â”€â”€ outputs/                  # ì¶œë ¥ íŒŒì¼
â”‚       â”œâ”€â”€ conversations/       # ì €ì¥ëœ ëŒ€í™” ë‚´ìš©
â”‚       â””â”€â”€ summaries/           # ì €ì¥ëœ ìš”ì•½
â”‚
â”œâ”€â”€ experiments/                   # ì‹¤í—˜ í´ë”
â”‚   â””â”€â”€ ë‚ ì§œ/                     # YYYYMMDD
â”‚       â””â”€â”€ ë‚ ì§œ_ì‹œê°„_ì‹¤í—˜ëª…/     # ì‹¤í—˜ë³„ í´ë”
â”‚           â”œâ”€â”€ experiment.log   # ë¡œê·¸ íŒŒì¼
â”‚           â”œâ”€â”€ config.yaml      # ì‹¤í—˜ ì„¤ì •
â”‚           â”œâ”€â”€ results.json     # ì‹¤í—˜ ê²°ê³¼
â”‚           â””â”€â”€ ...
â”‚
â”œâ”€â”€ scripts/                       # ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ collect_papers.py         # ë…¼ë¬¸ ìˆ˜ì§‘ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ build_vectordb.py         # VectorDB êµ¬ì¶•
â”‚   â”œâ”€â”€ init_database.py          # DB ì´ˆê¸°í™”
â”‚   â””â”€â”€ evaluate_rag.py           # RAG í‰ê°€
â”‚
â”œâ”€â”€ tests/                         # í…ŒìŠ¤íŠ¸ ì½”ë“œ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_agent.py             # Agent í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ test_rag.py               # RAG í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ test_tools.py             # ë„êµ¬ í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ test_integration.py       # í†µí•© í…ŒìŠ¤íŠ¸
â”‚
â”œâ”€â”€ docs/                          # ë¬¸ì„œ
â”‚   â”œâ”€â”€ PRD/                      # PRD ë¬¸ì„œë“¤
â”‚   â”‚   â”œâ”€â”€ 01_í”„ë¡œì íŠ¸_ê°œìš”.md
â”‚   â”‚   â”œâ”€â”€ 02_í”„ë¡œì íŠ¸_êµ¬ì¡°.md
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ rules/                    # ê·œì¹™ ë¬¸ì„œ
â”‚   â”‚   â”œâ”€â”€ logger_ì‚¬ìš©ë²•.md
â”‚   â”‚   â”œâ”€â”€ ì‹¤í—˜_í´ë”ëª…_ê·œì¹™.md
â”‚   â”‚   â””â”€â”€ commit_style.md
â”‚   â”‚
â”‚   â”œâ”€â”€ roles/                    # ì—­í•  ë¬¸ì„œ
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ mermaid_style.md          # Mermaid ìŠ¤íƒ€ì¼ ê°€ì´ë“œ
â”‚
â””â”€â”€ database/                      # DB ê´€ë ¨ íŒŒì¼
    â”œâ”€â”€ schema.sql                # PostgreSQL ìŠ¤í‚¤ë§ˆ
    â”œâ”€â”€ migrations/               # ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸
    â””â”€â”€ seeds/                    # ì‹œë“œ ë°ì´í„° (ìš©ì–´ì§‘ ë“±)
```

---

## 2. ëª¨ë“ˆë³„ ìƒì„¸ ì„¤ëª…

### 2.1 AI Agent (`src/agent/`)

#### ì—­í• 
- ì‚¬ìš©ì ì§ˆë¬¸ì„ ë¶„ì„í•˜ì—¬ ì ì ˆí•œ ë„êµ¬ ì„ íƒ
- LangGraph StateGraphë¥¼ ì‚¬ìš©í•œ ì›Œí¬í”Œë¡œìš° ê´€ë¦¬
- ë„êµ¬ ì‹¤í–‰ ê²°ê³¼ë¥¼ LLMì— ì „ë‹¬í•˜ì—¬ ìµœì¢… ë‹µë³€ ìƒì„±

#### ì£¼ìš” íŒŒì¼
- `graph.py`: StateGraph ì •ì˜ ë° ì»´íŒŒì¼
- `nodes.py`: ê° ë…¸ë“œ í•¨ìˆ˜ (router_node, search_paper_node ë“±)
- `state.py`: AgentState TypedDict ì •ì˜
- `router.py`: ì§ˆë¬¸ ìœ í˜• ë¶„ë¥˜ ë¡œì§

#### ì±…ì„ì
- ìµœí˜„í™” (íŒ€ì¥)

---

### 2.2 ë„êµ¬ (`src/tools/`)

#### ì—­í• 
- AI Agentê°€ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ ì œê³µ
- Langchain @tool ë°ì½”ë ˆì´í„° ì‚¬ìš©
- ê° ë„êµ¬ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥

#### ì£¼ìš” íŒŒì¼
1. `general.py`: ì¼ë°˜ ì§ˆë¬¸ì— ëŒ€í•œ ì§ì ‘ ë‹µë³€
2. `rag_search.py`: ë…¼ë¬¸ ë°ì´í„°ë² ì´ìŠ¤ ê²€ìƒ‰
3. `web_search.py`: TavilySearchResults í™œìš© ì›¹ ê²€ìƒ‰
4. `glossary.py`: ìš©ì–´ì§‘ ê²€ìƒ‰ ë° ì„¤ëª…
5. `summarize.py`: load_summarize_chain í™œìš© ìš”ì•½
6. `file_save.py`: ëŒ€í™”/ìš”ì•½ ë‚´ìš© íŒŒì¼ ì €ì¥

#### ì±…ì„ì
- `general.py`: ìµœí˜„í™”
- `rag_search.py`, `glossary.py`: ì‹ ì¤€ì—½
- `summarize.py`: ìµœí˜„í™”
- `web_search.py`, `file_save.py`: ì„ì˜ˆìŠ¬

---

### 2.3 RAG ì‹œìŠ¤í…œ (`src/rag/`)

#### ì—­í• 
- Vector DBì™€ ì—°ë™í•˜ì—¬ ë¬¸ì„œ ê²€ìƒ‰
- ì„ë² ë”© ìƒì„± ë° ê´€ë¦¬
- ê²€ìƒ‰ ê²°ê³¼ ì¬ìˆœìœ„í™” (ì„ íƒ)

#### ì£¼ìš” íŒŒì¼
- `retriever.py`: VectorStoreRetriever, MultiQueryRetriever
- `embeddings.py`: OpenAIEmbeddings ë˜í¼
- `vector_store.py`: PGVector ì¸í„°í˜ì´ìŠ¤
- `reranker.py`: ContextualCompressionRetriever (ì„ íƒ)

#### ì±…ì„ì
- ì‹ ì¤€ì—½

---

### 2.4 LLM í´ë¼ì´ì–¸íŠ¸ (`src/llm/`)

#### ì—­í• 
- ChatOpenAI ë˜í¼ ì œê³µ
- ì—ëŸ¬ í•¸ë“¤ë§ ë° ì¬ì‹œë„ ë¡œì§
- ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ì²˜ë¦¬
- í† í° ì‚¬ìš©ëŸ‰ ì¶”ì 

#### ì£¼ìš” íŒŒì¼
- `client.py`: LLMClient í´ë˜ìŠ¤
- `config.py`: ëª¨ë¸ ì„¤ì • (GPT-4, GPT-3.5-turbo)

#### ì±…ì„ì
- ìµœí˜„í™”

---

### 2.5 í”„ë¡¬í”„íŠ¸ (`src/prompts/`)

#### ì—­í• 
- ë‚œì´ë„ë³„ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì œê³µ
- ChatPromptTemplate ì‚¬ìš©
- ë„êµ¬ë³„ í”„ë¡¬í”„íŠ¸ ì •ì˜

#### ì£¼ìš” íŒŒì¼
- `templates.py`: ê³µí†µ PromptTemplate
- `easy_mode.py`: Easy ëª¨ë“œ í”„ë¡¬í”„íŠ¸
- `hard_mode.py`: Hard ëª¨ë“œ í”„ë¡¬í”„íŠ¸

#### ì±…ì„ì
- ì„ì˜ˆìŠ¬

---

### 2.6 ë°ì´í„° ì²˜ë¦¬ (`src/data/`)

#### ì—­í• 
- ë…¼ë¬¸ PDF ë¡œë“œ ë° ì „ì²˜ë¦¬
- í…ìŠ¤íŠ¸ ë¶„í•  (RecursiveCharacterTextSplitter)
- ì„ë² ë”© ìƒì„±

#### ì£¼ìš” íŒŒì¼
- `document_loader.py`: PyPDFLoader í™œìš©
- `text_splitter.py`: RecursiveCharacterTextSplitter
- `embedder.py`: ì„ë² ë”© ìƒì„± ë° ë°°ì¹˜ ì²˜ë¦¬

#### ì±…ì„ì
- ë°•ì¬í™ (10/31ê¹Œì§€)

---

### 2.7 Streamlit UI (`ui/`)

#### ì—­í• 
- ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ì œê³µ
- ì±„íŒ… ì¸í„°í˜ì´ìŠ¤, ë‚œì´ë„ ì„ íƒ
- StreamlitCallbackHandlerë¡œ Agent ì—°ë™
- íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥

#### ì£¼ìš” íŒŒì¼
- `app.py`: ë©”ì¸ UI
- `components/chat_interface.py`: ì±„íŒ… UI
- `components/sidebar.py`: ì‚¬ì´ë“œë°”
- `components/file_download.py`: ë‹¤ìš´ë¡œë“œ ë²„íŠ¼

#### ì±…ì„ì
- ì„ì˜ˆìŠ¬

---

## 3. ëª¨ë“ˆ ê°„ ì˜ì¡´ì„±

### 3.1 ì˜ì¡´ì„± ë‹¤ì´ì–´ê·¸ë¨

```mermaid
graph TB
    subgraph Frontend["í”„ë¡ íŠ¸ì—”ë“œ ê³„ì¸µ"]
        direction LR
        UI[ğŸ“± ui/app.py<br/>Streamlit UI] --> Main[âš™ï¸ main.py<br/>ì—”íŠ¸ë¦¬í¬ì¸íŠ¸]
    end

    subgraph CoreLogic["í•µì‹¬ ë¡œì§ ê³„ì¸µ"]
        direction TB
        Agent[ğŸ¤– agent/graph.py<br/>LangGraph]
        Tools[ğŸ”§ tools/*<br/>ë„êµ¬ ëª¨ìŒ]
        LLM[ğŸ’¬ llm/client.py<br/>ChatOpenAI]
        Memory[ğŸ’¾ memory/<br/>chat_history.py]
    end

    subgraph DataAccess["ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ"]
        direction TB
        RAG[ğŸ“Š rag/retriever.py<br/>ë¬¸ì„œ ê²€ìƒ‰]
        VectorStore[ğŸ’¾ rag/vector_store.py<br/>PGVector]
        Embeddings[ğŸ”¢ rag/embeddings.py<br/>ì„ë² ë”© ê´€ë¦¬]
        DB[ğŸ—„ï¸ utils/db.py<br/>PostgreSQL]
        Prompts[ğŸ“ prompts/templates.py<br/>í”„ë¡¬í”„íŠ¸]
    end

    %% ê³„ì¸µ ê°„ ì—°ê²°
    Frontend --> CoreLogic
    Main --> Agent

    %% í•µì‹¬ ë¡œì§ ë‚´ë¶€ ì—°ê²°
    Agent --> Tools
    Agent --> LLM
    Agent --> Memory

    %% ë°ì´í„° ì ‘ê·¼ ì—°ê²°
    Tools --> RAG
    Tools --> DB
    RAG --> VectorStore
    RAG --> Embeddings
    LLM --> Prompts

    %% Subgraph ìŠ¤íƒ€ì¼
    style Frontend fill:#e1f5ff,stroke:#01579b,stroke-width:3px,color:#000
    style CoreLogic fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style DataAccess fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (í”„ë¡ íŠ¸ì—”ë“œ - íŒŒë‘ ê³„ì—´)
    style UI fill:#90caf9,stroke:#1976d2,color:#000
    style Main fill:#64b5f6,stroke:#1976d2,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (í•µì‹¬ ë¡œì§ - ë³´ë¼ ê³„ì—´)
    style Agent fill:#ce93d8,stroke:#7b1fa2,color:#000
    style Tools fill:#ba68c8,stroke:#7b1fa2,color:#fff
    style LLM fill:#ab47bc,stroke:#4a148c,color:#fff
    style Memory fill:#9c27b0,stroke:#4a148c,color:#fff

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë°ì´í„° ì ‘ê·¼ - ë…¹ìƒ‰ ê³„ì—´)
    style RAG fill:#a5d6a7,stroke:#388e3c,color:#000
    style VectorStore fill:#81c784,stroke:#2e7d32,color:#000
    style Embeddings fill:#81c784,stroke:#2e7d32,color:#000
    style DB fill:#81c784,stroke:#2e7d32,color:#000
    style Prompts fill:#66bb6a,stroke:#2e7d32,color:#fff
```

### 3.2 ì˜ì¡´ì„± ê·œì¹™

1. **ê³„ì¸µì  ì˜ì¡´ì„±**
   - ìƒìœ„ ê³„ì¸µì€ í•˜ìœ„ ê³„ì¸µì„ ì°¸ì¡° ê°€ëŠ¥
   - í•˜ìœ„ ê³„ì¸µì€ ìƒìœ„ ê³„ì¸µì„ ì°¸ì¡° ë¶ˆê°€
   - ë™ì¼ ê³„ì¸µ ë‚´ì—ì„œëŠ” ìˆœí™˜ ì˜ì¡´ì„± ê¸ˆì§€

2. **ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬**
   - ê° ëª¨ë“ˆì€ ëª…í™•í•œ ì¸í„°í˜ì´ìŠ¤ ì œê³µ
   - êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ì€ ìˆ¨ê¹€ (ìº¡ìŠí™”)

3. **ê³µí†µ ìœ í‹¸ë¦¬í‹°**
   - `utils/` ëª¨ë“ˆì€ ëª¨ë“  ê³„ì¸µì—ì„œ ì‚¬ìš© ê°€ëŠ¥
   - ë‹¨, utilsëŠ” ë‹¤ë¥¸ ëª¨ë“ˆì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ

---

## 4. ë°ì´í„° íë¦„

### 4.1 ì‚¬ìš©ì ì§ˆë¬¸ ì²˜ë¦¬ íë¦„

```mermaid
graph TB
    subgraph Input["ğŸ”¸ ì§ˆë¬¸ ì…ë ¥"]
        direction LR
        User[ì‚¬ìš©ì ì§ˆë¬¸ ì…ë ¥] --> Difficulty{ë‚œì´ë„ ì„ íƒ<br/>Easy / Hard}
    end

    subgraph AgentProcessing["ğŸ”¹ Agent ë¼ìš°íŒ…"]
        direction LR
        Difficulty --> Router{ë¼ìš°í„° ë…¸ë“œ<br/>ì§ˆë¬¸ ë¶„ì„}
        Router -->|ì¼ë°˜ ì§ˆë¬¸| GeneralTool[ì¼ë°˜ ë‹µë³€ ë„êµ¬]
        Router -->|ë…¼ë¬¸ ê²€ìƒ‰| RAGTool[RAG ê²€ìƒ‰ ë„êµ¬]
        Router -->|ìµœì‹  ì •ë³´| WebTool[ì›¹ ê²€ìƒ‰ ë„êµ¬]
        Router -->|ìš©ì–´ ì§ˆë¬¸| GlossaryTool[ìš©ì–´ì§‘ ë„êµ¬]
        Router -->|ìš”ì•½ ìš”ì²­| SummarizeTool[ë…¼ë¬¸ ìš”ì•½ ë„êµ¬]
        Router -->|ì €ì¥ ìš”ì²­| SaveTool[íŒŒì¼ ì €ì¥ ë„êµ¬]
    end

    subgraph DataRetrieval["ğŸ”º ë°ì´í„° ì¡°íšŒ"]
        direction LR
        GeneralTool --> LLMDirect[ğŸ¤– LLM ì§ì ‘ í˜¸ì¶œ]
        RAGTool --> VectorDB[(ğŸ’¾ PGVector<br/>ë…¼ë¬¸ ì„ë² ë”©)]
        GlossaryTool --> PostgreSQL[(ğŸ’¾ PostgreSQL<br/>ìš©ì–´ì§‘)]
        WebTool --> TavilyAPI[ğŸ” Tavily API<br/>ì›¹ ê²€ìƒ‰]
    end

    subgraph ResponseGen["ğŸ”¶ ìµœì¢… ë‹µë³€ ìƒì„±"]
        direction LR
        LLMDirect --> LLM[ğŸ¤– ChatOpenAI<br/>GPT-4]
        VectorDB --> LLM
        PostgreSQL --> LLM
        TavilyAPI --> LLM
        LLM --> Answer[âœ… ìµœì¢… ë‹µë³€<br/>ë‚œì´ë„ ì ìš©]
    end

    subgraph Evaluation["ğŸ’¡ í‰ê°€"]
        direction LR
        Answer --> Eval[ğŸ“Š ë‹µë³€ í’ˆì§ˆ í‰ê°€<br/>ì •í™•ë„, ê´€ë ¨ì„±]
        Eval --> UserFeedback[ì‚¬ìš©ì í”¼ë“œë°±]
    end

    %% ë‹¨ê³„ ê°„ ì—°ê²°
    Input --> AgentProcessing
    AgentProcessing --> DataRetrieval
    DataRetrieval --> ResponseGen
    ResponseGen --> Evaluation

    %% Subgraph ìŠ¤íƒ€ì¼
    style Input fill:#e1f5ff,stroke:#01579b,stroke-width:3px,color:#000
    style AgentProcessing fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style DataRetrieval fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style ResponseGen fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000
    style Evaluation fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì…ë ¥ - íŒŒë‘ ê³„ì—´)
    style User fill:#90caf9,stroke:#1976d2,color:#000
    style Difficulty fill:#ba68c8,stroke:#7b1fa2,color:#fff

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (Agent - ë³´ë¼ ê³„ì—´)
    style Router fill:#ba68c8,stroke:#7b1fa2,color:#fff
    style GeneralTool fill:#ce93d8,stroke:#7b1fa2,color:#000
    style RAGTool fill:#ce93d8,stroke:#7b1fa2,color:#000
    style WebTool fill:#ce93d8,stroke:#7b1fa2,color:#000
    style GlossaryTool fill:#ce93d8,stroke:#7b1fa2,color:#000
    style SummarizeTool fill:#ce93d8,stroke:#7b1fa2,color:#000
    style SaveTool fill:#ce93d8,stroke:#7b1fa2,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë°ì´í„° ì¡°íšŒ - ë…¹ìƒ‰ ê³„ì—´)
    style LLMDirect fill:#a5d6a7,stroke:#388e3c,color:#000
    style VectorDB fill:#a5d6a7,stroke:#388e3c,color:#000
    style PostgreSQL fill:#a5d6a7,stroke:#388e3c,color:#000
    style TavilyAPI fill:#81c784,stroke:#2e7d32,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ë‹µë³€ ìƒì„± - ì£¼í™© ê³„ì—´)
    style LLM fill:#ffcc80,stroke:#f57c00,color:#000
    style Answer fill:#ffb74d,stroke:#f57c00,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (í‰ê°€ - ë¹¨ê°• ê³„ì—´)
    style Eval fill:#ef9a9a,stroke:#c62828,color:#000
    style UserFeedback fill:#e57373,stroke:#c62828,color:#000
```

---

## 5. ì„¤ì • íŒŒì¼

### 5.1 í™˜ê²½ ë³€ìˆ˜ (.env)

```bash
# OpenAI API
OPENAI_API_KEY=your-openai-api-key

# PostgreSQL
POSTGRES_USER=user
POSTGRES_PASSWORD=password
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=papers

# Tavily Search API
TAVILY_API_KEY=your-tavily-api-key

# ê°œë°œ í™˜ê²½
ENVIRONMENT=development  # development, production
LOG_LEVEL=INFO          # DEBUG, INFO, WARNING, ERROR
```

### 5.2 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • (configs/db_config.yaml)

```yaml
postgresql:
  host: localhost
  port: 5432
  database: papers
  user: ${POSTGRES_USER}
  password: ${POSTGRES_PASSWORD}

pgvector:
  collections:
    - name: paper_chunks
      dimension: 1536  # OpenAI text-embedding-3-small
    - name: paper_abstracts
      dimension: 1536
    - name: glossary_embeddings
      dimension: 1536
```

### 5.3 ëª¨ë¸ ì„¤ì • (configs/model_config.yaml)

```yaml
llm:
  development:
    model: gpt-3.5-turbo
    temperature: 0.7
    max_tokens: 2000
  production:
    model: gpt-4
    temperature: 0.7
    max_tokens: 3000

embeddings:
  model: text-embedding-3-small
  dimension: 1536
  batch_size: 100
```

---

## 6. ì½”ë“œ êµ¬ì¡° ê·œì¹™

### 6.1 ì„í¬íŠ¸ ìˆœì„œ

```python
# 1. í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬
import os
import sys
from datetime import datetime

# 2. ì„œë“œíŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬
import numpy as np
from langchain.tools import tool
from langchain_openai import ChatOpenAI

# 3. ë¡œì»¬ ëª¨ë“ˆ
from src.utils.logger import Logger
from src.llm.client import LLMClient
```

### 6.2 ë„¤ì´ë° ê·œì¹™

- **íŒŒì¼ëª…**: snake_case (ì˜ˆ: `rag_search.py`)
- **í´ë˜ìŠ¤ëª…**: PascalCase (ì˜ˆ: `LLMClient`)
- **í•¨ìˆ˜ëª…**: snake_case (ì˜ˆ: `search_paper_database`)
- **ìƒìˆ˜**: UPPER_SNAKE_CASE (ì˜ˆ: `MAX_CHUNK_SIZE`)
- **ë³€ìˆ˜**: snake_case (ì˜ˆ: `user_query`)

### 6.3 ë…ìŠ¤íŠ¸ë§

```python
def search_paper_database(query: str, k: int = 5) -> list:
    """
    ë…¼ë¬¸ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê´€ë ¨ ë…¼ë¬¸ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤.

    Args:
        query (str): ê²€ìƒ‰ ì§ˆì˜
        k (int): ë°˜í™˜í•  ë¬¸ì„œ ê°œìˆ˜ (ê¸°ë³¸ê°’: 5)

    Returns:
        list: ê²€ìƒ‰ëœ Document ê°ì²´ ë¦¬ìŠ¤íŠ¸

    Raises:
        ValueError: queryê°€ ë¹ˆ ë¬¸ìì—´ì¸ ê²½ìš°

    Example:
        >>> docs = search_paper_database("Transformer architecture", k=3)
        >>> print(len(docs))
        3
    """
    pass
```

---

## 7. í…ŒìŠ¤íŠ¸ êµ¬ì¡°

### 7.1 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- ê° ëª¨ë“ˆë³„ë¡œ ë…ë¦½ì ì¸ í…ŒìŠ¤íŠ¸
- `tests/test_ëª¨ë“ˆëª….py` í˜•ì‹

### 7.2 í†µí•© í…ŒìŠ¤íŠ¸
- ì—¬ëŸ¬ ëª¨ë“ˆì´ í•¨ê»˜ ë™ì‘í•˜ëŠ” í…ŒìŠ¤íŠ¸
- `tests/test_integration.py`

### 7.3 ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
- ì‹¤ì œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ í…ŒìŠ¤íŠ¸
- 10ê°œ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦

---

## 8. ì°¸ê³  ìë£Œ

- Python í”„ë¡œì íŠ¸ êµ¬ì¡°: https://docs.python-guide.org/writing/structure/
- Langchain í”„ë¡œì íŠ¸ êµ¬ì¡°: https://python.langchain.com/docs/
- PostgreSQL ì„¤ì •: https://www.postgresql.org/docs/current/config-setting.html
