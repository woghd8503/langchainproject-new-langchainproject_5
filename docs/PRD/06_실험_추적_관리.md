# 06. ì‹¤í—˜ ì¶”ì  ê´€ë¦¬

## ë¬¸ì„œ ì •ë³´
- **ì‘ì„±ì¼**: 2025-10-30
- **í”„ë¡œì íŠ¸ëª…**: ë…¼ë¬¸ ë¦¬ë·° ì±—ë´‡ (AI Agent + RAG)
- **íŒ€ëª…**: ì—°ê²°ì˜ ë¯¼ì¡±

---

## 1. ì‹¤í—˜ í´ë” êµ¬ì¡°

### 1.1 ì‹¤í—˜ í´ë” ìƒì„± íë¦„

```mermaid
graph TB
    subgraph Init["ğŸ”¸ ì´ˆê¸°í™” & í´ë” ìƒì„±"]
        direction LR
        A[ì±—ë´‡ ì‹¤í–‰<br/>ì‹œì‘] --> B[ë‚ ì§œ/ì‹œê°„ ìƒì„±<br/>Session ID ë¶€ì—¬]
        B --> C[í´ë” ìƒì„±<br/>ë‚ ì§œ_ì‹œê°„_session_XXX]
        C --> D[ì„œë¸Œ í´ë” 6ê°œ ìƒì„±<br/>tools, database, prompts, ui, outputs, evaluation]
        D --> E[ğŸ’¾ metadata.json<br/>Logger ì´ˆê¸°í™”]
    end

    subgraph Execute["ğŸ”¹ ì±—ë´‡ ì‹¤í–‰ & ê¸°ë¡"]
        direction LR
        F[ì‚¬ìš©ì ì§ˆë¬¸<br/>ë‚œì´ë„ ì„ íƒ] --> G[AI Agent<br/>ë„êµ¬ ì„ íƒ]
        G --> H[ë„êµ¬ ì‹¤í–‰<br/>RAG/ì›¹ê²€ìƒ‰/ìš©ì–´ì§‘...]
        H --> I[ê° í´ë”ì— ê¸°ë¡<br/>ë¡œê·¸, ì¿¼ë¦¬, í”„ë¡¬í”„íŠ¸, UI]
        I --> J[í‰ê°€ ì§€í‘œ ìˆ˜ì§‘<br/>Recall, ë¹„ìš©, ì‘ë‹µì‹œê°„]
    end

    subgraph Finish["ğŸ”º ì¢…ë£Œ & ì €ì¥"]
        direction LR
        K[ìµœì¢… ë‹µë³€ ìƒì„±] --> L[ğŸ’¾ outputs/<br/>response.txt ì €ì¥]
        L --> M[metadata.json<br/>ì—…ë°ì´íŠ¸]
        M --> N[Logger ì¢…ë£Œ<br/>ì‹¤í—˜ ì™„ë£Œ]
    end

    Init --> Execute
    Execute --> Finish

    %% Subgraph ìŠ¤íƒ€ì¼
    style Init fill:#e1f5ff,stroke:#01579b,stroke-width:3px,color:#000
    style Execute fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style Finish fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì´ˆê¸°í™” - íŒŒë‘ ê³„ì—´)
    style A fill:#90caf9,stroke:#1976d2,color:#000
    style B fill:#81d4fa,stroke:#0288d1,color:#000
    style C fill:#64b5f6,stroke:#1976d2,color:#000
    style D fill:#42a5f5,stroke:#1565c0,color:#000
    style E fill:#42a5f5,stroke:#1565c0,color:#000

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì‹¤í–‰ - ë³´ë¼ ê³„ì—´)
    style F fill:#ce93d8,stroke:#7b1fa2,color:#000
    style G fill:#ba68c8,stroke:#7b1fa2,color:#fff
    style H fill:#ab47bc,stroke:#4a148c,color:#fff
    style I fill:#9c27b0,stroke:#4a148c,color:#fff
    style J fill:#9c27b0,stroke:#4a148c,color:#fff

    %% ë…¸ë“œ ìŠ¤íƒ€ì¼ (ì¢…ë£Œ - ë…¹ìƒ‰ ê³„ì—´)
    style K fill:#a5d6a7,stroke:#388e3c,color:#000
    style L fill:#81c784,stroke:#2e7d32,color:#000
    style M fill:#66bb6a,stroke:#2e7d32,color:#fff
    style N fill:#66bb6a,stroke:#2e7d32,color:#fff
```

**ì‹¤í—˜ í´ë” ìƒì„± íë¦„ ì„¤ëª…:**
- **ì´ˆê¸°í™” ë‹¨ê³„**: ì±—ë´‡ ì‹¤í–‰ ì‹œ ìë™ìœ¼ë¡œ Session ID ë¶€ì—¬ (session_001, 002...) â†’ í´ë” ë° ì„œë¸Œ í´ë” 6ê°œ ìƒì„± â†’ metadata.jsonê³¼ Logger ì´ˆê¸°í™”
- **ì‹¤í–‰ ë‹¨ê³„**: ì‚¬ìš©ì ì§ˆë¬¸ ì…ë ¥ ë° ë‚œì´ë„ ì„ íƒ â†’ AI Agentê°€ ì ì ˆí•œ ë„êµ¬ ì„ íƒ (RAG, ì›¹ê²€ìƒ‰, ìš©ì–´ì§‘ ë“±) â†’ ì‹¤í–‰ ê³¼ì •ì„ ê° í´ë”ì— ê¸°ë¡ (ë„êµ¬ ë¡œê·¸, DB ì¿¼ë¦¬, í”„ë¡¬í”„íŠ¸, UI ì¸í„°ë™ì…˜) â†’ í‰ê°€ ì§€í‘œ ìˆ˜ì§‘ (Recall@K, ë¹„ìš©, ì‘ë‹µì‹œê°„)
- **ì¢…ë£Œ ë‹¨ê³„**: ìµœì¢… ë‹µë³€ ìƒì„± â†’ outputs/response.txt ì €ì¥ â†’ metadata.json ì—…ë°ì´íŠ¸ â†’ Logger ì¢…ë£Œ ë° ì‹¤í—˜ ì™„ë£Œ

### 1.2 í•„ìˆ˜ í´ë” êµ¬ì¡°

ëª¨ë“  ì±—ë´‡ ì‹¤í–‰ ê²°ê³¼ëŠ” `experiments/ë‚ ì§œ/ë‚ ì§œ_ì‹œê°„_session_XXX/` êµ¬ì¡°ë¡œ ì €ì¥:

```
experiments/
â””â”€â”€ 20251031/                                # ë‚ ì§œ (YYYYMMDD)
    â””â”€â”€ 20251031_103015_session_001/         # ì‹œê°„_session_ID
        â”‚
        â”œâ”€â”€ metadata.json                    # â­ ì „ì²´ ì‹¤í—˜ ë©”íƒ€ë°ì´í„°
        â”œâ”€â”€ chatbot.log                      # ë©”ì¸ ì‹¤í–‰ ë¡œê·¸
        â”œâ”€â”€ config.yaml                      # ì „ì²´ ì„¤ì •
        â”‚
        â”œâ”€â”€ tools/                           # ğŸ”§ ë„êµ¬ ì‹¤í–‰ ë¡œê·¸
        â”‚   â”œâ”€â”€ rag_paper.log                # ë…¼ë¬¸ ê²€ìƒ‰ ë¡œê·¸
        â”‚   â”œâ”€â”€ rag_glossary.log             # ìš©ì–´ì§‘ ê²€ìƒ‰ ë¡œê·¸
        â”‚   â”œâ”€â”€ web_search.log               # ì›¹ ê²€ìƒ‰ ë¡œê·¸
        â”‚   â”œâ”€â”€ summary_paper.log            # ë…¼ë¬¸ ìš”ì•½ ë¡œê·¸
        â”‚   â”œâ”€â”€ file_save.log                # íŒŒì¼ ì €ì¥ ë¡œê·¸
        â”‚   â””â”€â”€ general.log                  # ì¼ë°˜ ë‹µë³€ ë¡œê·¸
        â”‚
        â”œâ”€â”€ database/                        # ğŸ—„ï¸ DB ê´€ë ¨ ê¸°ë¡
        â”‚   â”œâ”€â”€ queries.sql                  # ì‹¤í–‰ëœ SQL ì¿¼ë¦¬ ëª¨ìŒ
        â”‚   â”œâ”€â”€ pgvector_searches.json       # pgvector ê²€ìƒ‰ ê¸°ë¡
        â”‚   â”œâ”€â”€ search_results.json          # DB ê²€ìƒ‰ ê²°ê³¼
        â”‚   â””â”€â”€ db_performance.json          # ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„ ë“±
        â”‚
        â”œâ”€â”€ prompts/                         # ğŸ’¬ í”„ë¡¬í”„íŠ¸ ê¸°ë¡
        â”‚   â”œâ”€â”€ system_prompt.txt            # ì‚¬ìš©ëœ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
        â”‚   â”œâ”€â”€ user_prompt.txt              # ì‚¬ìš©ì ì§ˆë¬¸ + ì»¨í…ìŠ¤íŠ¸
        â”‚   â”œâ”€â”€ final_prompt.txt             # LLMì— ì „ë‹¬ëœ ìµœì¢… í”„ë¡¬í”„íŠ¸
        â”‚   â””â”€â”€ prompt_template.yaml         # í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì •ë³´
        â”‚
        â”œâ”€â”€ ui/                              # ğŸ–¥ï¸ UI ê´€ë ¨ ê¸°ë¡
        â”‚   â”œâ”€â”€ streamlit_session.json       # Streamlit ì„¸ì…˜ ìƒíƒœ
        â”‚   â”œâ”€â”€ user_interactions.log        # ì‚¬ìš©ì ì¸í„°ë™ì…˜ ë¡œê·¸
        â”‚   â””â”€â”€ ui_events.json               # UI ì´ë²¤íŠ¸ ê¸°ë¡
        â”‚
        â”œâ”€â”€ outputs/                         # ğŸ“„ ìƒì„±ëœ ê²°ê³¼ë¬¼
        â”‚   â”œâ”€â”€ response.txt                 # ìµœì¢… ë‹µë³€
        â”‚   â”œâ”€â”€ summary.md                   # ìš”ì•½ë³¸ (ìˆì„ ê²½ìš°)
        â”‚   â””â”€â”€ saved_file.txt               # ì‚¬ìš©ìê°€ ì €ì¥ ìš”ì²­í•œ íŒŒì¼
        â”‚
        â”œâ”€â”€ evaluation/                      # ğŸ“Š í‰ê°€ ì§€í‘œ
        â”‚   â”œâ”€â”€ rag_metrics.json             # RAG í‰ê°€ ì§€í‘œ
        â”‚   â”œâ”€â”€ agent_accuracy.json          # Agent ì •í™•ë„
        â”‚   â”œâ”€â”€ latency_report.json          # ì‘ë‹µ ì‹œê°„ ë¶„ì„
        â”‚   â”œâ”€â”€ cost_analysis.json           # ë¹„ìš© ë¶„ì„
        â”‚   â””â”€â”€ test_results.json            # í…ŒìŠ¤íŠ¸ ê²°ê³¼
        â”‚
        â””â”€â”€ debug/                           # ğŸ› ë””ë²„ê·¸ ì •ë³´ (ì„ íƒ)
            â”œâ”€â”€ agent_trace.json             # Agent ì‹¤í–‰ ì¶”ì 
            â”œâ”€â”€ llm_tokens.json              # í† í° ì‚¬ìš©ëŸ‰
            â””â”€â”€ error_trace.log              # ì—ëŸ¬ ë°œìƒ ì‹œ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤
```

### 1.3 metadata.json (í•µì‹¬ ë©”íƒ€ë°ì´í„°)

ê° ì‹¤í—˜ì˜ í•µì‹¬ ì •ë³´ë¥¼ í•œ ê³³ì— ìš”ì•½:

```json
{
  "session_id": "001",
  "start_time": "2025-10-31T10:30:15",
  "end_time": "2025-10-31T10:32:45",
  "difficulty": "easy",
  "tool_used": "rag_paper",
  "user_query": "RAGì— ëŒ€í•´ ì•Œë ¤ì¤˜",
  "success": true,
  "response_time_ms": 2500,
  "response_length": 450,
  "model": "gpt-4",
  "temperature": 0.7,
  "tokens_used": {
    "prompt": 1200,
    "completion": 800,
    "total": 2000
  },
  "db_queries_count": 4,
  "db_total_time_ms": 120
}
```

---

## 2. Session ID ìë™ ë¶€ì—¬ ê·œì¹™

### 2.1 ìë™ ìƒì„± ë°©ì‹

ì±—ë´‡ ì‹¤í–‰ ì‹œë§ˆë‹¤ **Session IDê°€ ìë™ìœ¼ë¡œ ë¶€ì—¬**ë©ë‹ˆë‹¤:

- **í˜•ì‹**: `session_001`, `session_002`, `session_003` ...
- **ë¶€ì—¬ ë°©ì‹**: ë‹¹ì¼ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ìˆœì°¨ì ìœ¼ë¡œ ì¦ê°€
- **ì‹œì‘ ë²ˆí˜¸**: ë§¤ì¼ `001`ë¶€í„° ì‹œì‘

### 2.2 ì˜ˆì‹œ

```
experiments/20251031/
â”œâ”€â”€ 20251031_103015_session_001/   # ì˜¤ëŠ˜ ì²« ë²ˆì§¸ ì‹¤í–‰
â”œâ”€â”€ 20251031_110234_session_002/   # ì˜¤ëŠ˜ ë‘ ë²ˆì§¸ ì‹¤í–‰
â””â”€â”€ 20251031_143520_session_003/   # ì˜¤ëŠ˜ ì„¸ ë²ˆì§¸ ì‹¤í–‰

experiments/20251101/
â””â”€â”€ 20251101_090012_session_001/   # ë‹¤ìŒ ë‚ , ë‹¤ì‹œ 001ë¶€í„° ì‹œì‘
```

### 2.3 ì¤‘ë³µ ë°©ì§€

ExperimentManager í´ë˜ìŠ¤ê°€ ìë™ìœ¼ë¡œ:
1. ë‹¹ì¼ í´ë”(`experiments/20251031/`) ìŠ¤ìº”
2. ê¸°ì¡´ session í´ë” í™•ì¸
3. ê°€ì¥ í° ë²ˆí˜¸ + 1ë¡œ ìƒˆ session ID ë¶€ì—¬

---

## 3. ExperimentManager ì‚¬ìš©ë²•

### 3.1 ê¸°ë³¸ ì‚¬ìš© (ìë™ í´ë” ìƒì„±)

```python
from src.utils.experiment_manager import ExperimentManager

# with ë¬¸ìœ¼ë¡œ ìë™ ì´ˆê¸°í™” ë° ì¢…ë£Œ
with ExperimentManager() as exp:
    # ìë™ìœ¼ë¡œ ë‹¤ìŒ ì‘ì—… ìˆ˜í–‰:
    # 1. experiments/20251031/20251031_103015_session_001/ ìƒì„±
    # 2. ì„œë¸Œ í´ë” ìƒì„± (tools, database, prompts, ui, outputs, evaluation)
    # 3. metadata.json ì´ˆê¸°í™”
    # 4. Logger ì´ˆê¸°í™”

    # ë©”ì¸ ë¡œê·¸ ê¸°ë¡
    exp.logger.write("ì±—ë´‡ ì‹¤í–‰ ì‹œì‘")

    # ì‚¬ìš©ì ì§ˆë¬¸
    question = "RAGì— ëŒ€í•´ ì•Œë ¤ì¤˜"

    # ë©”íƒ€ë°ì´í„° ì—…ë°ì´íŠ¸
    exp.update_metadata(
        user_query=question,
        difficulty="easy"
    )

    # ... ì±—ë´‡ ì‹¤í–‰ ...

    # with ë¸”ë¡ì´ ëë‚˜ë©´ ìë™ìœ¼ë¡œ close() í˜¸ì¶œ
```

### 3.2 ë„êµ¬ë³„ Logger ì‚¬ìš©

```python
with ExperimentManager() as exp:
    # ë„êµ¬ë³„ ë…ë¦½ Logger ìƒì„±
    rag_logger = exp.get_tool_logger('rag_paper')
    rag_logger.write("ë…¼ë¬¸ ê²€ìƒ‰ ì‹œì‘")
    rag_logger.write("ê²€ìƒ‰ ì™„ë£Œ: 5ê°œ ë…¼ë¬¸ ë°œê²¬")
    rag_logger.close()

    # ë‹¤ë¥¸ ë„êµ¬
    web_logger = exp.get_tool_logger('web_search')
    web_logger.write("ì›¹ ê²€ìƒ‰ ì‹œì‘")
```

### 3.3 DB ì¿¼ë¦¬ ê¸°ë¡

```python
with ExperimentManager() as exp:
    # SQL ì¿¼ë¦¬ ê¸°ë¡
    exp.log_sql_query(
        query="SELECT * FROM papers WHERE paper_id = 123",
        description="ë…¼ë¬¸ ë©”íƒ€ë°ì´í„° ì¡°íšŒ",
        tool="rag_paper",
        execution_time_ms=12
    )

    # pgvector ê²€ìƒ‰ ê¸°ë¡
    exp.log_pgvector_search({
        "tool": "rag_paper",
        "collection": "paper_chunks",
        "query_text": "RAGì— ëŒ€í•´ ì•Œë ¤ì¤˜",
        "top_k": 5,
        "execution_time_ms": 45
    })

    # ê²€ìƒ‰ ê²°ê³¼ ì €ì¥
    exp.save_search_results("rag_paper", {
        "query": "RAGì— ëŒ€í•´ ì•Œë ¤ì¤˜",
        "results_count": 5,
        "papers": [...]
    })
```

### 3.4 í”„ë¡¬í”„íŠ¸ ì €ì¥

```python
with ExperimentManager() as exp:
    # ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì €ì¥
    exp.save_system_prompt(
        system_prompt="ë‹¹ì‹ ì€ ë…¼ë¬¸ì„ ì‰½ê²Œ ì„¤ëª…í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.",
        metadata={"ë‚œì´ë„": "easy", "í…œí”Œë¦¿": "EASY_SYSTEM_PROMPT"}
    )

    # ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ ì €ì¥
    exp.save_user_prompt(
        user_prompt="[ì°¸ê³  ë…¼ë¬¸]\n...\n\n[ì§ˆë¬¸]\nRAGì— ëŒ€í•´ ì•Œë ¤ì¤˜",
        metadata={"ê²€ìƒ‰ ê²°ê³¼ ìˆ˜": 5}
    )

    # ìµœì¢… í”„ë¡¬í”„íŠ¸ ì €ì¥
    exp.save_final_prompt(final_prompt)

    # í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì •ë³´ ì €ì¥
    exp.save_prompt_template({
        "difficulty": "easy",
        "llm_config": {"model": "gpt-4", "temperature": 0.7}
    })
```

### 3.5 UI ì¸í„°ë™ì…˜ ê¸°ë¡

```python
with ExperimentManager() as exp:
    # ì¸í„°ë™ì…˜ ë¡œê·¸
    exp.log_ui_interaction("í˜ì´ì§€ ì ‘ì†")
    exp.log_ui_interaction("ë‚œì´ë„ ì„ íƒ: easy")
    exp.log_ui_interaction("ì§ˆë¬¸ ì…ë ¥: RAGì— ëŒ€í•´ ì•Œë ¤ì¤˜")

    # UI ì´ë²¤íŠ¸ ê¸°ë¡
    exp.log_ui_event({
        "event_type": "difficulty_changed",
        "old_value": None,
        "new_value": "easy"
    })

    # Streamlit ì„¸ì…˜ ì €ì¥
    exp.save_streamlit_session({
        "session_id": "abc123",
        "messages": [...]
    })
```

### 3.6 í‰ê°€ ì§€í‘œ ì €ì¥

```python
with ExperimentManager() as exp:
    # RAG í‰ê°€ ì§€í‘œ
    exp.save_rag_metrics({
        "retrieval_metrics": {"recall_at_5": 0.8},
        "generation_metrics": {"faithfulness": 0.95}
    })

    # Agent ì •í™•ë„
    exp.save_agent_accuracy({
        "routing_decision": {"predicted_tool": "rag_paper", "correct": True}
    })

    # ì‘ë‹µ ì‹œê°„ ë¶„ì„
    exp.save_latency_report({
        "total_latency": {"total_time_ms": 5000, "status": "PASS"}
    })

    # ë¹„ìš© ë¶„ì„
    exp.save_cost_analysis({
        "llm_usage": {"total_tokens": 2345},
        "cost_breakdown_krw": {"total_cost": 30.51}
    })
```

### 3.7 ê²°ê³¼ë¬¼ ì €ì¥

```python
with ExperimentManager() as exp:
    # ìµœì¢… ë‹µë³€ ì €ì¥
    exp.save_output('response.txt', final_answer)

    # ìš”ì•½ë³¸ ì €ì¥ (ìˆì„ ê²½ìš°)
    exp.save_output('summary.md', summary_text)

    # ì‚¬ìš©ì ì €ì¥ ìš”ì²­ íŒŒì¼
    exp.save_output('saved_file.txt', content)
```

---

## 4. ì €ì¥ë˜ëŠ” íŒŒì¼ ë° í´ë”

### 4.1 ìµœìƒìœ„ í•„ìˆ˜ íŒŒì¼

| íŒŒì¼ëª… | ì„¤ëª… | ìƒì„± ë°©ë²• |
|--------|------|----------|
| **metadata.json** | ì‹¤í—˜ í•µì‹¬ ì •ë³´ ìš”ì•½ | `exp.update_metadata()` |
| **chatbot.log** | ë©”ì¸ ì‹¤í–‰ ë¡œê·¸ | `exp.logger.write()` |
| **config.yaml** | ì „ì²´ ì„¤ì • ì •ë³´ | `exp.save_config()` |

### 4.2 tools/ í´ë” (ë„êµ¬ë³„ ë¡œê·¸)

| íŒŒì¼ëª… | ì„¤ëª… | ìƒì„± ì‹œì  |
|--------|------|----------|
| `rag_paper.log` | ë…¼ë¬¸ ê²€ìƒ‰ ë¡œê·¸ | rag_paper ë„êµ¬ ì‹¤í–‰ ì‹œ |
| `rag_glossary.log` | ìš©ì–´ì§‘ ê²€ìƒ‰ ë¡œê·¸ | rag_glossary ë„êµ¬ ì‹¤í–‰ ì‹œ |
| `web_search.log` | ì›¹ ê²€ìƒ‰ ë¡œê·¸ | web_search ë„êµ¬ ì‹¤í–‰ ì‹œ |
| `summary_paper.log` | ë…¼ë¬¸ ìš”ì•½ ë¡œê·¸ | summary_paper ë„êµ¬ ì‹¤í–‰ ì‹œ |
| `file_save.log` | íŒŒì¼ ì €ì¥ ë¡œê·¸ | file_save ë„êµ¬ ì‹¤í–‰ ì‹œ |
| `general.log` | ì¼ë°˜ ë‹µë³€ ë¡œê·¸ | general ë„êµ¬ ì‹¤í–‰ ì‹œ |

**íŠ¹ì§•**: ì‹¤í–‰ëœ ë„êµ¬ë§Œ ë¡œê·¸ íŒŒì¼ ìƒì„± (ë¹ˆ íŒŒì¼ ì—†ìŒ)

### 4.3 database/ í´ë” (DB ê´€ë ¨)

| íŒŒì¼ëª… | ì„¤ëª… | ë‚´ìš© |
|--------|------|------|
| `queries.sql` | ì‹¤í–‰ëœ SQL ì¿¼ë¦¬ ëª¨ìŒ | ì‹œê°„ìˆœ SQL ì¿¼ë¦¬ + ì„¤ëª… |
| `pgvector_searches.json` | pgvector ê²€ìƒ‰ ê¸°ë¡ | ì„ë² ë”©, ê²€ìƒ‰ íƒ€ì…, ê²°ê³¼ ìˆ˜ ë“± |
| `search_results.json` | DB ê²€ìƒ‰ ê²°ê³¼ | ë…¼ë¬¸/ìš©ì–´ ìƒì„¸ ì •ë³´ |
| `db_performance.json` | ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„ ë“± | ì¿¼ë¦¬ë³„ ì„±ëŠ¥ ë¶„ì„ |

### 4.4 prompts/ í´ë” (í”„ë¡¬í”„íŠ¸)

| íŒŒì¼ëª… | ì„¤ëª… | ë‚´ìš© |
|--------|------|------|
| `system_prompt.txt` | ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ | Easy/Hard ë‚œì´ë„ë³„ í”„ë¡¬í”„íŠ¸ |
| `user_prompt.txt` | ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ | ì§ˆë¬¸ + ê²€ìƒ‰ëœ ì»¨í…ìŠ¤íŠ¸ |
| `final_prompt.txt` | ìµœì¢… í”„ë¡¬í”„íŠ¸ | LLMì— ì „ë‹¬ëœ ì „ì²´ í”„ë¡¬í”„íŠ¸ |
| `prompt_template.yaml` | í…œí”Œë¦¿ ì •ë³´ | LLM ì„¤ì •, í† í° ìˆ˜ ë“± |

### 4.5 ui/ í´ë” (Streamlit UI)

| íŒŒì¼ëª… | ì„¤ëª… | ë‚´ìš© |
|--------|------|------|
| `streamlit_session.json` | ì„¸ì…˜ ìƒíƒœ | ë©”ì‹œì§€ íˆìŠ¤í† ë¦¬, ìœ„ì ¯ ìƒíƒœ |
| `user_interactions.log` | ì¸í„°ë™ì…˜ ë¡œê·¸ | í´ë¦­, ì…ë ¥ ë“± ì‚¬ìš©ì í–‰ë™ |
| `ui_events.json` | UI ì´ë²¤íŠ¸ | ì´ë²¤íŠ¸ íƒ€ì„ë¼ì¸ |

### 4.6 outputs/ í´ë” (ê²°ê³¼ë¬¼)

| íŒŒì¼ëª… | ì„¤ëª… | ìƒì„± ì‹œì  |
|--------|------|----------|
| `response.txt` | ìµœì¢… ë‹µë³€ | í•­ìƒ ìƒì„± |
| `summary.md` | ë…¼ë¬¸ ìš”ì•½ë³¸ | ìš”ì•½ ë„êµ¬ ì‚¬ìš© ì‹œ |
| `saved_file.txt` | ì €ì¥ ìš”ì²­ íŒŒì¼ | íŒŒì¼ ì €ì¥ ë„êµ¬ ì‚¬ìš© ì‹œ |

### 4.7 evaluation/ í´ë” (í‰ê°€ ì§€í‘œ)

| íŒŒì¼ëª… | ì„¤ëª… | ì£¼ìš” ì§€í‘œ |
|--------|------|----------|
| `rag_metrics.json` | RAG í‰ê°€ | Recall@K, Precision, Faithfulness |
| `agent_accuracy.json` | Agent ì •í™•ë„ | ë„êµ¬ ì„ íƒ ì •í™•ë„, ì‹¤í–‰ íë¦„ |
| `latency_report.json` | ì‘ë‹µ ì‹œê°„ | p50/p95/p99, ë³‘ëª© ë¶„ì„ |
| `cost_analysis.json` | ë¹„ìš© ë¶„ì„ | í† í° ì‚¬ìš©ëŸ‰, USD/KRW ë¹„ìš© |
| `test_results.json` | í…ŒìŠ¤íŠ¸ ê²°ê³¼ | ì‹œë‚˜ë¦¬ì˜¤ë³„ ì„±ê³µ/ì‹¤íŒ¨ |

### 4.8 debug/ í´ë” (ì„ íƒ ì‚¬í•­)

| íŒŒì¼ëª… | ì„¤ëª… | ìƒì„± ì‹œì  |
|--------|------|----------|
| `agent_trace.json` | Agent ì‹¤í–‰ ì¶”ì  | ë””ë²„ê¹… í•„ìš” ì‹œ |
| `llm_tokens.json` | í† í° ì‚¬ìš©ëŸ‰ | ë¹„ìš© ìƒì„¸ ë¶„ì„ ì‹œ |
| `error_trace.log` | ì—ëŸ¬ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ | ì—ëŸ¬ ë°œìƒ ì‹œ |

---

## 5. ì‹¤í—˜ ê²€ìƒ‰ ë° ë¶„ì„

### 5.1 ë©”íƒ€ë°ì´í„° ê¸°ë°˜ ê²€ìƒ‰

`scripts/find_experiments.py` ìŠ¤í¬ë¦½íŠ¸ë¡œ ì‹¤í—˜ ê²€ìƒ‰:

```python
from pathlib import Path
import json

# ë‚œì´ë„ë³„ ê²€ìƒ‰
easy_experiments = find_experiments(difficulty="easy")
hard_experiments = find_experiments(difficulty="hard")

# ë„êµ¬ë³„ ê²€ìƒ‰
rag_experiments = find_experiments(tool="rag_paper")
web_experiments = find_experiments(tool="web_search")

# ë‚ ì§œë³„ ê²€ìƒ‰
today_experiments = find_experiments(date="20251031")

# ì‘ë‹µ ì‹œê°„ ê¸°ì¤€ ê²€ìƒ‰
fast_experiments = find_experiments(max_response_time=3000)
slow_experiments = find_experiments(min_response_time=5000)

# ë³µí•© ì¡°ê±´ ê²€ìƒ‰
filtered = find_experiments(
    difficulty="easy",
    tool="rag_paper",
    min_response_time=2000,
    max_response_time=5000
)
```

### 5.2 í‰ê°€ ì§€í‘œ ì§‘ê³„

```python
# ëª¨ë“  ì‹¤í—˜ì˜ í‰ê°€ ì§€í‘œ ìˆ˜ì§‘
def aggregate_metrics(date: str):
    metrics_list = []
    for session_dir in Path(f"experiments/{date}").glob("*_session_*"):
        rag_metrics_file = session_dir / "evaluation" / "rag_metrics.json"
        if rag_metrics_file.exists():
            with open(rag_metrics_file) as f:
                metrics_list.append(json.load(f))

    # í‰ê·  ê³„ì‚°
    avg_recall = sum(m['retrieval_metrics']['recall_at_5'] for m in metrics_list) / len(metrics_list)
    avg_faithfulness = sum(m['generation_metrics']['faithfulness'] for m in metrics_list) / len(metrics_list)

    return {
        'total_sessions': len(metrics_list),
        'avg_recall_at_5': avg_recall,
        'avg_faithfulness': avg_faithfulness
    }
```

---

## 6. ì°¸ê³  ë¬¸ì„œ

- [ì‹¤í—˜_í´ë”_êµ¬ì¡°_ìµœì¢…ì•ˆ.md](../references/ì‹¤í—˜_í´ë”_êµ¬ì¡°_ìµœì¢…ì•ˆ.md) - ì „ì²´ í´ë” êµ¬ì¡° ìƒì„¸ ê°€ì´ë“œ
- [05_ë¡œê¹…_ì‹œìŠ¤í…œ.md](05_ë¡œê¹…_ì‹œìŠ¤í…œ.md) - Logger í´ë˜ìŠ¤ ì‚¬ìš©ë²•
- [09_í‰ê°€_ê¸°ì¤€.md](09_í‰ê°€_ê¸°ì¤€.md) - RAG, Agent, DB í‰ê°€ ì§€í‘œ
- [ë‹´ë‹¹ì—­í• _06_ë¡œê¹…_ëª¨ë‹ˆí„°ë§.md](../roles/ë‹´ë‹¹ì—­í• _06_ë¡œê¹…_ëª¨ë‹ˆí„°ë§.md) - ExperimentManager êµ¬í˜„ ë‹´ë‹¹
